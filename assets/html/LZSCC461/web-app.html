<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Web scraping, interactive graphics, Shiny Apps, package building, and more | Lancaster University Leipzig LZSCC.461 R Programming</title>
  <meta name="description" content="5 Web scraping, interactive graphics, Shiny Apps, package building, and more | Lancaster University Leipzig LZSCC.461 R Programming" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Web scraping, interactive graphics, Shiny Apps, package building, and more | Lancaster University Leipzig LZSCC.461 R Programming" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Web scraping, interactive graphics, Shiny Apps, package building, and more | Lancaster University Leipzig LZSCC.461 R Programming" />
  
  
  

<meta name="author" content="Lecturer: Robert Lösch" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="string.html"/>
<link rel="next" href="further-reading.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<script src="libs/detect-resize-0.5.3/jquery.resize.js"></script>
<link href="libs/jquery-ui-1.11.4/jquery-ui.min.css" rel="stylesheet" />
<script src="libs/jquery-ui-1.11.4/jquery-ui.min.js"></script>
<script src="libs/d3-3.5.2/d3.min.js"></script>
<script src="libs/vega-1.4.3/vega.min.js"></script>
<script src="libs/lodash-4.17.21/lodash.min.js"></script>
<script>var lodash = _.noConflict();</script>
<link href="libs/ggvis-0.4.9/css/ggvis.css" rel="stylesheet" />
<script src="libs/ggvis-0.4.9/js/ggvis.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r.html"><a href="introduction-to-r.html"><i class="fa fa-check"></i><strong>0</strong> Introduction to R</a>
<ul>
<li class="chapter" data-level="0.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#background"><i class="fa fa-check"></i><b>0.1</b> Background</a></li>
<li class="chapter" data-level="0.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#saving-your-work"><i class="fa fa-check"></i><b>0.2</b> Saving your work</a></li>
<li class="chapter" data-level="0.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#getting-started"><i class="fa fa-check"></i><b>0.3</b> Getting started</a></li>
<li class="chapter" data-level="0.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#s:0help"><i class="fa fa-check"></i><b>0.4</b> Getting Help</a></li>
<li class="chapter" data-level="0.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#r-scripts"><i class="fa fa-check"></i><b>0.5</b> R scripts</a></li>
<li class="chapter" data-level="0.6" data-path="introduction-to-r.html"><a href="introduction-to-r.html#r-markdown"><i class="fa fa-check"></i><b>0.6</b> R Markdown</a></li>
<li class="chapter" data-level="0.7" data-path="introduction-to-r.html"><a href="introduction-to-r.html#functions"><i class="fa fa-check"></i><b>0.7</b> Functions</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="read-plot.html"><a href="read-plot.html"><i class="fa fa-check"></i><b>1</b> Data manipulation and plotting in R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="read-plot.html"><a href="read-plot.html#before-getting-started"><i class="fa fa-check"></i><b>1.1</b> Before getting started</a></li>
<li class="chapter" data-level="1.2" data-path="read-plot.html"><a href="read-plot.html#working-with-data-in-modern-r"><i class="fa fa-check"></i><b>1.2</b> Working with data in modern R</a></li>
<li class="chapter" data-level="1.3" data-path="read-plot.html"><a href="read-plot.html#data-types"><i class="fa fa-check"></i><b>1.3</b> Data Types</a></li>
<li class="chapter" data-level="1.4" data-path="read-plot.html"><a href="read-plot.html#logical-comparisons-and-boolean-operations"><i class="fa fa-check"></i><b>1.4</b> Logical comparisons and Boolean operations</a></li>
<li class="chapter" data-level="1.5" data-path="read-plot.html"><a href="read-plot.html#plots"><i class="fa fa-check"></i><b>1.5</b> Plots</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="time.html"><a href="time.html"><i class="fa fa-check"></i><b>2</b> Time manipulation, aggregation and summarisation</a>
<ul>
<li class="chapter" data-level="2.1" data-path="time.html"><a href="time.html#from-last-week"><i class="fa fa-check"></i><b>2.1</b> From last week</a></li>
<li class="chapter" data-level="2.2" data-path="time.html"><a href="time.html#dates-and-timestamps-in-r"><i class="fa fa-check"></i><b>2.2</b> Dates and timestamps in R</a></li>
<li class="chapter" data-level="2.3" data-path="time.html"><a href="time.html#summarising-data-over-time"><i class="fa fa-check"></i><b>2.3</b> Summarising data over time</a></li>
<li class="chapter" data-level="2.4" data-path="time.html"><a href="time.html#a-timestamp-split-over-several-columns"><i class="fa fa-check"></i><b>2.4</b> A timestamp split over several columns</a></li>
<li class="chapter" data-level="2.5" data-path="time.html"><a href="time.html#time-zones"><i class="fa fa-check"></i><b>2.5</b> Time zones</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="loops-sim.html"><a href="loops-sim.html"><i class="fa fa-check"></i><b>3</b> Loops, Conditional Statements, and Simulation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="loops-sim.html"><a href="loops-sim.html#before-you-start"><i class="fa fa-check"></i><b>3.1</b> Before you start</a></li>
<li class="chapter" data-level="3.2" data-path="loops-sim.html"><a href="loops-sim.html#loops"><i class="fa fa-check"></i><b>3.2</b> Loops</a></li>
<li class="chapter" data-level="3.3" data-path="loops-sim.html"><a href="loops-sim.html#conditional-statements"><i class="fa fa-check"></i><b>3.3</b> Conditional statements</a></li>
<li class="chapter" data-level="3.4" data-path="loops-sim.html"><a href="loops-sim.html#probability-and-simulation"><i class="fa fa-check"></i><b>3.4</b> Probability and Simulation</a></li>
<li class="chapter" data-level="3.5" data-path="loops-sim.html"><a href="loops-sim.html#combining-loops-and-simulation"><i class="fa fa-check"></i><b>3.5</b> Combining Loops and Simulation</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="string.html"><a href="string.html"><i class="fa fa-check"></i><b>4</b> String processing</a>
<ul>
<li class="chapter" data-level="4.1" data-path="string.html"><a href="string.html#preamble"><i class="fa fa-check"></i><b>4.1</b> Preamble</a></li>
<li class="chapter" data-level="4.2" data-path="string.html"><a href="string.html#introducing-regular-expressions"><i class="fa fa-check"></i><b>4.2</b> Introducing regular expressions</a></li>
<li class="chapter" data-level="4.3" data-path="string.html"><a href="string.html#working-with-strings-and-regular-expressions"><i class="fa fa-check"></i><b>4.3</b> Working with strings and regular expressions</a></li>
<li class="chapter" data-level="4.4" data-path="string.html"><a href="string.html#string-exercises"><i class="fa fa-check"></i><b>4.4</b> String Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="web-app.html"><a href="web-app.html"><i class="fa fa-check"></i><b>5</b> Web scraping, interactive graphics, Shiny Apps, package building, and more</a>
<ul>
<li class="chapter" data-level="5.1" data-path="web-app.html"><a href="web-app.html#packages"><i class="fa fa-check"></i><b>5.1</b> Packages</a></li>
<li class="chapter" data-level="5.2" data-path="web-app.html"><a href="web-app.html#collecting-data"><i class="fa fa-check"></i><b>5.2</b> Collecting data</a></li>
<li class="chapter" data-level="5.3" data-path="web-app.html"><a href="web-app.html#alternative-graphics"><i class="fa fa-check"></i><b>5.3</b> Alternative graphics</a></li>
<li class="chapter" data-level="5.4" data-path="web-app.html"><a href="web-app.html#shiny-web-applications"><i class="fa fa-check"></i><b>5.4</b> Shiny Web Applications</a></li>
<li class="chapter" data-level="5.5" data-path="web-app.html"><a href="web-app.html#rmarkdown-html-notebooks-and-ipythonjupyter-notebooks"><i class="fa fa-check"></i><b>5.5</b> Rmarkdown HTML notebooks and Ipython/Jupyter notebooks</a></li>
<li class="chapter" data-level="5.6" data-path="web-app.html"><a href="web-app.html#exercise-housing-in-nairobi"><i class="fa fa-check"></i><b>5.6</b> Exercise: Housing in Nairobi</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="further-reading.html"><a href="further-reading.html"><i class="fa fa-check"></i>Further reading</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Lancaster University Leipzig LZSCC.461 R Programming</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="web-app" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">5</span> Web scraping, interactive graphics, Shiny Apps, package building, and more<a href="web-app.html#web-app" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="packages" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Packages<a href="web-app.html#packages" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>Install the new packages <code>rvest</code> and <code>ggvis</code>. It will also be worth installing <code>readr</code> and <code>purrr</code>, if you haven’t done so.</p></li>
<li><p>Load in the new packages and <code>ggplot2</code>. Collectively, you can load in <code>readr</code>, <code>purrr</code> &amp; <code>ggplot2</code> via <code>tidyverse</code>:</p></li>
</ul>
<div class="sourceCode" id="cb568"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb568-1"><a href="web-app.html#cb568-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb568-2"><a href="web-app.html#cb568-2" tabindex="-1"></a><span class="fu">library</span>(ggvis)</span>
<span id="cb568-3"><a href="web-app.html#cb568-3" tabindex="-1"></a><span class="fu">library</span>(rvest)</span></code></pre></div>
</div>
<div id="collecting-data" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Collecting data<a href="web-app.html#collecting-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>So far the data we’ve used has been provided for you. More importantly, it’s been given to you in a nice format (e.g. no missing values). In practice you’ll find that most data are messy and that analysing real data requires you to spend time cleaning and manipulating the data into a useable form before you can do your analysis.</p>
<p>One of the best sources of data is the internet. There are now over a billion websites containing data on almost anything you can think of (e.g. income, world poverty, property values, film releases, etc.).</p>
<div id="simple-scraping" class="section level3 hasAnchor" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Simple scraping<a href="web-app.html#simple-scraping" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In Chapter 0 we looked at a dataset containing information about planets in our solar system. In that exercise we input that data manually. However, we can obtain these data by <em>scraping</em> the data directly from the web.<a href="#fn14" class="footnote-ref" id="fnref14"><sup>14</sup></a></p>
<p>The <code>rvest</code> package from Hadley Wickham will allow us to read the data directly from the website. So let’s try it out. Start by loading the package if you haven’t already.</p>
<div class="sourceCode" id="cb569"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb569-1"><a href="web-app.html#cb569-1" tabindex="-1"></a><span class="fu">library</span>(rvest)</span></code></pre></div>
<p>Once we’ve found a good website containing the data we want, we can scrape the data from the website and store it in a <code>data.frame</code> object</p>
<div class="sourceCode" id="cb570"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb570-1"><a href="web-app.html#cb570-1" tabindex="-1"></a>html <span class="ot">&lt;-</span> <span class="fu">read_html</span>(<span class="st">&quot;http://nssdc.gsfc.nasa.gov/planetary/factsheet/&quot;</span>) </span>
<span id="cb570-2"><a href="web-app.html#cb570-2" tabindex="-1"></a>html_data <span class="ot">&lt;-</span> <span class="fu">html_node</span>(html, <span class="st">&quot;table&quot;</span>) <span class="co"># extract parts of HTML text</span></span>
<span id="cb570-3"><a href="web-app.html#cb570-3" tabindex="-1"></a>planet_data <span class="ot">&lt;-</span> <span class="fu">html_table</span>(html_data, <span class="at">header =</span> <span class="cn">TRUE</span>) <span class="co"># display table</span></span>
<span id="cb570-4"><a href="web-app.html#cb570-4" tabindex="-1"></a><span class="fu">head</span>(planet_data)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 11
##   ``         MERCURY VENUS EARTH MOON  MARS  JUPITER SATURN URANUS NEPTUNE PLUTO
##   &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt;
## 1 Mass (102… 0.330   4.87  5.97  0.073 0.642 1898    568    86.8   102     0.01…
## 2 Diameter … 4879    12,1… 12,7… 3475  6792  142,984 120,5… 51,118 49,528  2376 
## 3 Density (… 5429    5243  5514  3340  3934  1326    687    1270   1638    1850 
## 4 Gravity (… 3.7     8.9   9.8   1.6   3.7   23.1    9.0    8.7    11.0    0.7  
## 5 Escape Ve… 4.3     10.4  11.2  2.4   5.0   59.5    35.5   21.3   23.5    1.3  
## 6 Rotation … 1407.6  -583… 23.9  655.7 24.6  9.9     10.7   -17.2  16.1    -153…</code></pre>
<p>Essentially we’re going to be working with four main functions:</p>
<ul>
<li><code>read_html()</code> - used to set the webpage address</li>
<li><code>html_node()</code>/<code>html_nodes()</code> - select which parts of the website you want to scrape</li>
<li><code>html_table()</code> - convert an HTML table into a <code>data.frame</code> object</li>
<li><code>html_text()</code> - extract HTML text.</li>
</ul>
<p>Used correctly, these functions will allow you to scrape data from alot of websites. However, as you can imagine, the more complex the design of the website, the harder it will be to identify what you’re looking for.</p>
<p>You may find the <a href="https://selectorgadget.com" class="uri">https://selectorgadget.com</a> tool particularly useful. This tool can be added as an extension to Google Chrome.<a href="#fn15" class="footnote-ref" id="fnref15"><sup>15</sup></a> When activated you can simply hover your mouse over the section of the website you want to scrape and the selectorgadget tool will tell you what the xpath/CSS link is.</p>
<p>Piping is also helpful when running web scraping code. Piping allows you to direct the output from one function to another and then another and then another, etc. by using the <code>%&gt;%</code> operator from the <code>dplyr</code> package. As an example, here in an alternative way of implementing the above:</p>
<div class="sourceCode" id="cb572"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb572-1"><a href="web-app.html#cb572-1" tabindex="-1"></a>planet_data <span class="ot">&lt;-</span> </span>
<span id="cb572-2"><a href="web-app.html#cb572-2" tabindex="-1"></a>    <span class="fu">read_html</span>(<span class="st">&quot;http://nssdc.gsfc.nasa.gov/planetary/factsheet/&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb572-3"><a href="web-app.html#cb572-3" tabindex="-1"></a>    <span class="fu">html_node</span>(<span class="st">&quot;table&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb572-4"><a href="web-app.html#cb572-4" tabindex="-1"></a>    <span class="fu">html_table</span>(<span class="at">header =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>You’ll notice by comparing the two implementations, that <code>function(a, b)</code> is equivalent to <code>a %&gt;% function(b)</code>. We are plugging our variable into the first argument of the function. If instead we want <code>function(b, a)</code>, then we’ll need to use the form <code>a %&gt;% function(b, .)</code>.</p>
</div>
<div id="exercise-3" class="section level3 hasAnchor" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> Exercise<a href="web-app.html#exercise-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The planets dataset contains many unwanted characters (e.g. <code>*</code>, commas, words). Use regular expressions and string processing operations, to remove these to create a clean dataset.</p>
<!-- ### Google Scholar -->
<!-- Google scholar is a helpful resource for finding academic works. In addition to finding journal articles, you can also find profiles of researchers and see what they work on, the papers they publish, how influential they are, and who they work with. -->
<!-- Let's consider the Google Scholar page of Peter Diggle, Lancaster University Distiguished University Professor of Statistics. -->
<!-- ```{r} -->
<!-- page <- read_html("https://scholar.google.it/citations?user=wAxHYS8AAAAJ&hl=en") -->
<!-- ``` -->
<!-- On the Google Scholar page there are several tables. There is a summary of the researcher's output (top right). The main table contains the details of each of the researcher's papers. Let's scrape these two tables (remember the `.` indicates the contents from the pipe so far). -->
<!-- ```{r} -->
<!-- overview <- page %>%  -->
<!--     html_nodes("table") %>%  -->
<!--     .[[1]] %>%  -->
<!--     html_table() -->
<!-- citations <- page %>%  -->
<!--     html_nodes("table") %>%  -->
<!--     .[[2]] %>%  -->
<!--     html_table() %>%  -->
<!--     as.data.frame() %>% -->
<!--     .[-1, 2] %>%  -->
<!--     readr::parse_number() -->
<!-- ``` -->
<!-- * The first operation is straightforward. We're simply scraping the first list element (i.e. `[[1]]`), which is a table from the webpage. -->
<!-- * The second line is a little trickier with two additional operations. We convert the object to a `data.frame` and use `[-1, 2]` to remove the first row of the table and select the second column, just the citations. -->
<!-- * You'll often find in practice, especially when working with web scraping, that data isn't always presented in the most convenient way.The last operation, `readr::parse_number()`, is simply stripping everything out that isn't numeric.^[You can think of the `readr::parse_number()` function as a more advanced version of `as.numeric()`.] -->
<!-- We have obtained some of the information on the webpage. -->
<!-- ```{r} -->
<!-- head(overview) -->
<!-- head(citations) -->
<!-- ``` -->
<!-- ```{r diggle, fig.cap="The citations of Prof. Diggle's papers"} -->
<!-- barplot(citations, main = "How many times have Prof. Diggle's papers been cited?",  -->
<!--         ylab = 'Number of citations', col = "skyblue", xlab = "") -->
<!-- ``` -->
<!-- Let's have a look at his most famous works. Remember that the selectorgadget Chrome extension can help you find the name of the CSS tag you need to provide to `html_nodes()`. Another way is to press *Ctrl+Shift+I* in Chrome and view the HTML source code. Remember also that websites are frequently updated and so the next time you run this code it may fail if Google have changed the Google Scholar HTML code. This has happend to me when I was running the code from last year. -->
<!-- ```{r} -->
<!-- Titles <- page %>%  -->
<!--      html_nodes(css = ".gsc_a_at") %>% -->
<!--      html_text() -->
<!-- Titles -->
<!-- ``` -->
</div>
</div>
<div id="alternative-graphics" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Alternative graphics<a href="web-app.html#alternative-graphics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>By now we are familiar with using the <code>ggplot2</code> package instead of the base R graphics engine to produce figures. Howewever, we are going to cover few extra packages now.</p>
<div id="plotly" class="section level3 hasAnchor" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> Plotly<a href="web-app.html#plotly" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Plotly is an open-source data visualization library for R. It allows you to create interactive plots that you can use in dashboards or websites (you can save them as static images as well). The <code>ggplotly</code> function from the plotly package makes it easy to convert <code>ggplot2</code> graphics to interactive plotly graphics. Install the package and then load it.</p>
<div class="sourceCode" id="cb573"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb573-1"><a href="web-app.html#cb573-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;plotly&quot;</span>)</span></code></pre></div>
<p>Let’s take a look at an example using the <code>mtcars</code> dataset. The <code>mtcars</code> dataset contains data on 32 cars from 1973–74. Let’s start by plotting the horsepower (displacement) against the miles per gallon.</p>
<div class="sourceCode" id="cb574"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb574-1"><a href="web-app.html#cb574-1" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb574-2"><a href="web-app.html#cb574-2" tabindex="-1"></a></span>
<span id="cb574-3"><a href="web-app.html#cb574-3" tabindex="-1"></a><span class="co"># Load mtcars dataset</span></span>
<span id="cb574-4"><a href="web-app.html#cb574-4" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb574-5"><a href="web-app.html#cb574-5" tabindex="-1"></a></span>
<span id="cb574-6"><a href="web-app.html#cb574-6" tabindex="-1"></a><span class="co"># Create a ggplot</span></span>
<span id="cb574-7"><a href="web-app.html#cb574-7" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="fu">aes</span>(<span class="at">x =</span> mpg, <span class="at">y =</span> disp, <span class="at">color =</span> cyl)) <span class="sc">+</span></span>
<span id="cb574-8"><a href="web-app.html#cb574-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb574-9"><a href="web-app.html#cb574-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Miles Per Gallon vs Displacement&quot;</span>,</span>
<span id="cb574-10"><a href="web-app.html#cb574-10" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Miles Per Gallon&quot;</span>,</span>
<span id="cb574-11"><a href="web-app.html#cb574-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Displacement&quot;</span>,</span>
<span id="cb574-12"><a href="web-app.html#cb574-12" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Cylinders&quot;</span>)</span>
<span id="cb574-13"><a href="web-app.html#cb574-13" tabindex="-1"></a></span>
<span id="cb574-14"><a href="web-app.html#cb574-14" tabindex="-1"></a><span class="co"># Convert ggplot to a plotly object</span></span>
<span id="cb574-15"><a href="web-app.html#cb574-15" tabindex="-1"></a><span class="fu">ggplotly</span>(p)</span></code></pre></div>
<div class="plotly html-widget html-fill-item" id="htmlwidget-881f6630fd69c3051382" style="width:50%;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-881f6630fd69c3051382">{"x":{"data":[{"x":[21,21,22.800000000000001,21.399999999999999,18.699999999999999,18.100000000000001,14.300000000000001,24.399999999999999,22.800000000000001,19.199999999999999,17.800000000000001,16.399999999999999,17.300000000000001,15.199999999999999,10.4,10.4,14.699999999999999,32.399999999999999,30.399999999999999,33.899999999999999,21.5,15.5,15.199999999999999,13.300000000000001,19.199999999999999,27.300000000000001,26,30.399999999999999,15.800000000000001,19.699999999999999,15,21.399999999999999],"y":[160,160,108,258,360,225,360,146.69999999999999,140.80000000000001,167.59999999999999,167.59999999999999,275.80000000000001,275.80000000000001,275.80000000000001,472,460,440,78.700000000000003,75.700000000000003,71.099999999999994,120.09999999999999,318,304,350,400,79,120.3,95.099999999999994,351,145,301,121],"text":["mpg: 21.0<br />disp: 160.0<br />cyl: 6","mpg: 21.0<br />disp: 160.0<br />cyl: 6","mpg: 22.8<br />disp: 108.0<br />cyl: 4","mpg: 21.4<br />disp: 258.0<br />cyl: 6","mpg: 18.7<br />disp: 360.0<br />cyl: 8","mpg: 18.1<br />disp: 225.0<br />cyl: 6","mpg: 14.3<br />disp: 360.0<br />cyl: 8","mpg: 24.4<br />disp: 146.7<br />cyl: 4","mpg: 22.8<br />disp: 140.8<br />cyl: 4","mpg: 19.2<br />disp: 167.6<br />cyl: 6","mpg: 17.8<br />disp: 167.6<br />cyl: 6","mpg: 16.4<br />disp: 275.8<br />cyl: 8","mpg: 17.3<br />disp: 275.8<br />cyl: 8","mpg: 15.2<br />disp: 275.8<br />cyl: 8","mpg: 10.4<br />disp: 472.0<br />cyl: 8","mpg: 10.4<br />disp: 460.0<br />cyl: 8","mpg: 14.7<br />disp: 440.0<br />cyl: 8","mpg: 32.4<br />disp:  78.7<br />cyl: 4","mpg: 30.4<br />disp:  75.7<br />cyl: 4","mpg: 33.9<br />disp:  71.1<br />cyl: 4","mpg: 21.5<br />disp: 120.1<br />cyl: 4","mpg: 15.5<br />disp: 318.0<br />cyl: 8","mpg: 15.2<br />disp: 304.0<br />cyl: 8","mpg: 13.3<br />disp: 350.0<br />cyl: 8","mpg: 19.2<br />disp: 400.0<br />cyl: 8","mpg: 27.3<br />disp:  79.0<br />cyl: 4","mpg: 26.0<br />disp: 120.3<br />cyl: 4","mpg: 30.4<br />disp:  95.1<br />cyl: 4","mpg: 15.8<br />disp: 351.0<br />cyl: 8","mpg: 19.7<br />disp: 145.0<br />cyl: 6","mpg: 15.0<br />disp: 301.0<br />cyl: 8","mpg: 21.4<br />disp: 121.0<br />cyl: 4"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":["rgba(51,106,152,1)","rgba(51,106,152,1)","rgba(19,43,67,1)","rgba(51,106,152,1)","rgba(86,177,247,1)","rgba(51,106,152,1)","rgba(86,177,247,1)","rgba(19,43,67,1)","rgba(19,43,67,1)","rgba(51,106,152,1)","rgba(51,106,152,1)","rgba(86,177,247,1)","rgba(86,177,247,1)","rgba(86,177,247,1)","rgba(86,177,247,1)","rgba(86,177,247,1)","rgba(86,177,247,1)","rgba(19,43,67,1)","rgba(19,43,67,1)","rgba(19,43,67,1)","rgba(19,43,67,1)","rgba(86,177,247,1)","rgba(86,177,247,1)","rgba(86,177,247,1)","rgba(86,177,247,1)","rgba(19,43,67,1)","rgba(19,43,67,1)","rgba(19,43,67,1)","rgba(86,177,247,1)","rgba(51,106,152,1)","rgba(86,177,247,1)","rgba(19,43,67,1)"],"opacity":1,"size":11.338582677165356,"symbol":"circle","line":{"width":1.8897637795275593,"color":["rgba(51,106,152,1)","rgba(51,106,152,1)","rgba(19,43,67,1)","rgba(51,106,152,1)","rgba(86,177,247,1)","rgba(51,106,152,1)","rgba(86,177,247,1)","rgba(19,43,67,1)","rgba(19,43,67,1)","rgba(51,106,152,1)","rgba(51,106,152,1)","rgba(86,177,247,1)","rgba(86,177,247,1)","rgba(86,177,247,1)","rgba(86,177,247,1)","rgba(86,177,247,1)","rgba(86,177,247,1)","rgba(19,43,67,1)","rgba(19,43,67,1)","rgba(19,43,67,1)","rgba(19,43,67,1)","rgba(86,177,247,1)","rgba(86,177,247,1)","rgba(86,177,247,1)","rgba(86,177,247,1)","rgba(19,43,67,1)","rgba(19,43,67,1)","rgba(19,43,67,1)","rgba(86,177,247,1)","rgba(51,106,152,1)","rgba(86,177,247,1)","rgba(19,43,67,1)"]}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[10],"y":[100],"name":"a9fc8f46e192ca4f9c87bdea90404db7","type":"scatter","mode":"markers","opacity":0,"hoverinfo":"skip","showlegend":false,"marker":{"color":[0,1],"colorscale":[[0,"#132B43"],[0.0033444816053511683,"#132B44"],[0.0066889632107023367,"#132C44"],[0.010033444816053505,"#142C45"],[0.013377926421404673,"#142D45"],[0.016722408026755842,"#142D46"],[0.02006688963210701,"#142D46"],[0.023411371237458178,"#142E47"],[0.026755852842809347,"#152E47"],[0.030100334448160515,"#152F48"],[0.033444816053511683,"#152F48"],[0.036789297658862852,"#152F49"],[0.04013377926421402,"#153049"],[0.043478260869565188,"#16304A"],[0.046822742474916357,"#16304A"],[0.050167224080267525,"#16314B"],[0.053511705685618693,"#16314B"],[0.056856187290969862,"#16324C"],[0.06020066889632103,"#17324D"],[0.063545150501672198,"#17324D"],[0.066889632107023367,"#17334E"],[0.070234113712374535,"#17334E"],[0.073578595317725703,"#17344F"],[0.076923076923076872,"#18344F"],[0.08026755852842804,"#183450"],[0.083612040133779209,"#183550"],[0.086956521739130377,"#183551"],[0.090301003344481545,"#183651"],[0.093645484949832714,"#193652"],[0.096989966555183882,"#193652"],[0.10033444816053505,"#193753"],[0.10367892976588622,"#193754"],[0.10702341137123739,"#193854"],[0.11036789297658856,"#1A3855"],[0.11371237458193972,"#1A3955"],[0.11705685618729089,"#1A3956"],[0.12040133779264206,"#1A3956"],[0.12374581939799323,"#1A3A57"],[0.1270903010033444,"#1B3A57"],[0.13043478260869557,"#1B3B58"],[0.13377926421404673,"#1B3B59"],[0.1371237458193979,"#1B3B59"],[0.14046822742474907,"#1C3C5A"],[0.14381270903010024,"#1C3C5A"],[0.14715719063545141,"#1C3D5B"],[0.1505016722408028,"#1C3D5B"],[0.15384615384615374,"#1C3D5C"],[0.15719063545150513,"#1D3E5C"],[0.16053511705685608,"#1D3E5D"],[0.16387959866220747,"#1D3F5D"],[0.16722408026755842,"#1D3F5E"],[0.17056856187290981,"#1D3F5F"],[0.17391304347826075,"#1E405F"],[0.17725752508361214,"#1E4060"],[0.18060200668896309,"#1E4160"],[0.18394648829431448,"#1E4161"],[0.18729096989966543,"#1E4261"],[0.19063545150501682,"#1F4262"],[0.19397993311036799,"#1F4263"],[0.19732441471571915,"#1F4363"],[0.20066889632107032,"#1F4364"],[0.20401337792642149,"#1F4464"],[0.20735785953177266,"#204465"],[0.21070234113712383,"#204465"],[0.214046822742475,"#204566"],[0.21739130434782616,"#204566"],[0.22073578595317733,"#214667"],[0.2240802675585285,"#214668"],[0.22742474916387967,"#214768"],[0.23076923076923084,"#214769"],[0.23411371237458201,"#214769"],[0.23745819397993317,"#22486A"],[0.24080267558528434,"#22486A"],[0.24414715719063551,"#22496B"],[0.24749163879598668,"#22496C"],[0.25083612040133785,"#224A6C"],[0.25418060200668902,"#234A6D"],[0.25752508361204018,"#234A6D"],[0.26086956521739135,"#234B6E"],[0.26421404682274252,"#234B6E"],[0.26755852842809369,"#244C6F"],[0.27090301003344486,"#244C70"],[0.27424749163879603,"#244C70"],[0.27759197324414719,"#244D71"],[0.28093645484949836,"#244D71"],[0.28428093645484953,"#254E72"],[0.2876254180602007,"#254E72"],[0.29096989966555187,"#254F73"],[0.29431438127090304,"#254F74"],[0.2976588628762542,"#254F74"],[0.30100334448160537,"#265075"],[0.30434782608695654,"#265075"],[0.30769230769230771,"#265176"],[0.31103678929765888,"#265176"],[0.31438127090301005,"#275277"],[0.31772575250836121,"#275278"],[0.32107023411371238,"#275278"],[0.32441471571906355,"#275379"],[0.32775919732441472,"#275379"],[0.33110367892976589,"#28547A"],[0.33444816053511706,"#28547B"],[0.33779264214046822,"#28557B"],[0.34113712374581939,"#28557C"],[0.34448160535117056,"#28567C"],[0.34782608695652173,"#29567D"],[0.3511705685618729,"#29567D"],[0.35451505016722407,"#29577E"],[0.35785953177257523,"#29577F"],[0.3612040133779264,"#2A587F"],[0.36454849498327757,"#2A5880"],[0.36789297658862874,"#2A5980"],[0.37123745819397991,"#2A5981"],[0.37458193979933108,"#2A5982"],[0.37792642140468224,"#2B5A82"],[0.38127090301003341,"#2B5A83"],[0.38461538461538458,"#2B5B83"],[0.38795986622073575,"#2B5B84"],[0.39130434782608692,"#2C5C85"],[0.39464882943143809,"#2C5C85"],[0.39799331103678925,"#2C5D86"],[0.40133779264214042,"#2C5D86"],[0.40468227424749159,"#2C5D87"],[0.40802675585284276,"#2D5E87"],[0.41137123745819393,"#2D5E88"],[0.4147157190635451,"#2D5F89"],[0.41806020066889626,"#2D5F89"],[0.42140468227424743,"#2E608A"],[0.4247491638795986,"#2E608A"],[0.42809364548494977,"#2E618B"],[0.43143812709030094,"#2E618C"],[0.43478260869565211,"#2E618C"],[0.43812709030100327,"#2F628D"],[0.44147157190635444,"#2F628D"],[0.44481605351170561,"#2F638E"],[0.44816053511705678,"#2F638F"],[0.45150501672240795,"#30648F"],[0.45484949832775912,"#306490"],[0.45819397993311028,"#306590"],[0.46153846153846145,"#306591"],[0.46488294314381262,"#306592"],[0.46822742474916379,"#316692"],[0.47157190635451496,"#316693"],[0.47491638795986635,"#316793"],[0.47826086956521729,"#316794"],[0.48160535117056869,"#326895"],[0.48494983277591963,"#326895"],[0.48829431438127102,"#326996"],[0.49163879598662197,"#326996"],[0.49498327759197336,"#326997"],[0.4983277591973243,"#336A98"],[0.5016722408026757,"#336A98"],[0.50501672240802664,"#336B99"],[0.50836120401337803,"#336B99"],[0.51170568561872898,"#346C9A"],[0.51505016722408037,"#346C9B"],[0.51839464882943131,"#346D9B"],[0.52173913043478271,"#346D9C"],[0.52508361204013365,"#346E9D"],[0.52842809364548504,"#356E9D"],[0.53177257525083599,"#356E9E"],[0.53511705685618738,"#356F9E"],[0.53846153846153832,"#356F9F"],[0.54180602006688972,"#3670A0"],[0.54515050167224066,"#3670A0"],[0.54849498327759205,"#3671A1"],[0.551839464882943,"#3671A1"],[0.55518394648829439,"#3772A2"],[0.55852842809364533,"#3772A3"],[0.56187290969899673,"#3773A3"],[0.56521739130434767,"#3773A4"],[0.56856187290969906,"#3773A4"],[0.57190635451505001,"#3874A5"],[0.5752508361204014,"#3874A6"],[0.57859531772575234,"#3875A6"],[0.58193979933110374,"#3875A7"],[0.58528428093645468,"#3976A8"],[0.58862876254180607,"#3976A8"],[0.59197324414715702,"#3977A9"],[0.59531772575250841,"#3977A9"],[0.59866220735785936,"#3978AA"],[0.60200668896321075,"#3A78AB"],[0.60535117056856191,"#3A79AB"],[0.60869565217391308,"#3A79AC"],[0.61204013377926425,"#3A79AC"],[0.61538461538461542,"#3B7AAD"],[0.61872909698996659,"#3B7AAE"],[0.62207357859531776,"#3B7BAE"],[0.62541806020066892,"#3B7BAF"],[0.62876254180602009,"#3C7CB0"],[0.63210702341137126,"#3C7CB0"],[0.63545150501672243,"#3C7DB1"],[0.6387959866220736,"#3C7DB1"],[0.64214046822742477,"#3C7EB2"],[0.64548494983277593,"#3D7EB3"],[0.6488294314381271,"#3D7FB3"],[0.65217391304347827,"#3D7FB4"],[0.65551839464882944,"#3D7FB5"],[0.65886287625418061,"#3E80B5"],[0.66220735785953178,"#3E80B6"],[0.66555183946488294,"#3E81B6"],[0.66889632107023411,"#3E81B7"],[0.67224080267558528,"#3F82B8"],[0.67558528428093645,"#3F82B8"],[0.67892976588628762,"#3F83B9"],[0.68227424749163879,"#3F83BA"],[0.68561872909698995,"#4084BA"],[0.68896321070234112,"#4084BB"],[0.69230769230769229,"#4085BB"],[0.69565217391304346,"#4085BC"],[0.69899665551839463,"#4086BD"],[0.7023411371237458,"#4186BD"],[0.70568561872909696,"#4186BE"],[0.70903010033444813,"#4187BF"],[0.7123745819397993,"#4187BF"],[0.71571906354515047,"#4288C0"],[0.71906354515050164,"#4288C1"],[0.72240802675585281,"#4289C1"],[0.72575250836120397,"#4289C2"],[0.72909698996655514,"#438AC2"],[0.73244147157190631,"#438AC3"],[0.73578595317725748,"#438BC4"],[0.73913043478260865,"#438BC4"],[0.74247491638795982,"#438CC5"],[0.74581939799331098,"#448CC6"],[0.74916387959866215,"#448DC6"],[0.75250836120401332,"#448DC7"],[0.75585284280936449,"#448EC8"],[0.75919732441471566,"#458EC8"],[0.76254180602006683,"#458FC9"],[0.76588628762541799,"#458FC9"],[0.76923076923076916,"#458FCA"],[0.77257525083612055,"#4690CB"],[0.7759197324414715,"#4690CB"],[0.77926421404682289,"#4691CC"],[0.78260869565217384,"#4691CD"],[0.78595317725752523,"#4792CD"],[0.78929765886287617,"#4792CE"],[0.79264214046822756,"#4793CF"],[0.79598662207357851,"#4793CF"],[0.7993311036789299,"#4894D0"],[0.80267558528428085,"#4894D0"],[0.80602006688963224,"#4895D1"],[0.80936454849498318,"#4895D2"],[0.81270903010033457,"#4896D2"],[0.81605351170568552,"#4996D3"],[0.81939799331103691,"#4997D4"],[0.82274247491638786,"#4997D4"],[0.82608695652173925,"#4998D5"],[0.82943143812709019,"#4A98D6"],[0.83277591973244158,"#4A99D6"],[0.83612040133779253,"#4A99D7"],[0.83946488294314392,"#4A9AD8"],[0.84280936454849487,"#4B9AD8"],[0.84615384615384626,"#4B9BD9"],[0.8494983277591972,"#4B9BDA"],[0.85284280936454859,"#4B9BDA"],[0.85618729096989954,"#4C9CDB"],[0.85953177257525093,"#4C9CDB"],[0.86287625418060188,"#4C9DDC"],[0.86622073578595327,"#4C9DDD"],[0.86956521739130421,"#4D9EDD"],[0.8729096989966556,"#4D9EDE"],[0.87625418060200655,"#4D9FDF"],[0.87959866220735794,"#4D9FDF"],[0.88294314381270889,"#4DA0E0"],[0.88628762541806028,"#4EA0E1"],[0.88963210702341122,"#4EA1E1"],[0.89297658862876261,"#4EA1E2"],[0.89632107023411356,"#4EA2E3"],[0.89966555183946495,"#4FA2E3"],[0.9030100334448159,"#4FA3E4"],[0.90635451505016729,"#4FA3E5"],[0.90969899665551823,"#4FA4E5"],[0.91304347826086962,"#50A4E6"],[0.91638795986622057,"#50A5E7"],[0.91973244147157196,"#50A5E7"],[0.92307692307692291,"#50A6E8"],[0.9264214046822743,"#51A6E8"],[0.92976588628762524,"#51A7E9"],[0.93311036789297663,"#51A7EA"],[0.93645484949832758,"#51A8EA"],[0.93979933110367897,"#52A8EB"],[0.94314381270903014,"#52A9EC"],[0.94648829431438131,"#52A9EC"],[0.94983277591973247,"#52AAED"],[0.95317725752508364,"#53AAEE"],[0.95652173913043481,"#53ABEE"],[0.95986622073578598,"#53ABEF"],[0.96321070234113715,"#53ACF0"],[0.96655518394648832,"#54ACF0"],[0.96989966555183948,"#54ADF1"],[0.97324414715719065,"#54ADF2"],[0.97658862876254182,"#54AEF2"],[0.97993311036789299,"#55AEF3"],[0.98327759197324416,"#55AFF4"],[0.98662207357859533,"#55AFF4"],[0.98996655518394649,"#55B0F5"],[0.99331103678929766,"#56B0F6"],[0.99665551839464883,"#56B1F6"],[1,"#56B1F7"]],"colorbar":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":2.405153901216893,"thickness":23.039999999999996,"title":"Cylinders","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":18.596928185969279},"tickmode":"array","ticktext":["4","5","6","7","8"],"tickvals":[0.0016666666666666668,0.2508333333333333,0.49999999999999994,0.74916666666666665,0.99833333333333329],"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":14.877542548775427},"ticklen":2,"len":0.5}},"xaxis":"x","yaxis":"y","frame":null}],"layout":{"margin":{"t":51.334163553341639,"r":9.2984640929846432,"b":51.141552511415526,"l":54.860938148609392},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":18.596928185969279},"title":{"text":"Miles Per Gallon vs Displacement","font":{"color":"rgba(0,0,0,1)","family":"","size":22.316313823163139},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[9.2249999999999996,35.074999999999996],"tickmode":"array","ticktext":["10","15","20","25","30","35"],"tickvals":[10,15,20,25,30,35],"categoryorder":"array","categoryarray":["10","15","20","25","30","35"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":4.6492320464923198,"tickwidth":0.8453149175440583,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":14.877542548775427},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.8453149175440583,"zeroline":false,"anchor":"y","title":{"text":"Miles Per Gallon","font":{"color":"rgba(0,0,0,1)","family":"","size":18.596928185969279}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[51.054999999999993,492.04500000000002],"tickmode":"array","ticktext":["100","200","300","400"],"tickvals":[100,200,300,400],"categoryorder":"array","categoryarray":["100","200","300","400"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":4.6492320464923216,"tickwidth":0.8453149175440583,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":14.87754254877543},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.8453149175440583,"zeroline":false,"anchor":"x","title":{"text":"Displacement","font":{"color":"rgba(0,0,0,1)","family":"","size":18.596928185969279}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":2.405153901216893,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.877542548775427},"title":{"text":"Cylinders","font":{"color":"rgba(0,0,0,1)","family":"","size":18.596928185969279}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"b16540bf4d5f":{"x":{},"y":{},"colour":{},"type":"scatter"}},"cur_data":"b16540bf4d5f","visdat":{"b16540bf4d5f":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>In this example, we create a scatter plot using <code>ggplot2</code>, and we convert this <code>ggplot2</code> graphic into an plotly graphic using the <code>ggplotly</code> function. The resulting plot is interactive and can be explored by hovering over the points, zooming in, and more.</p>
<p>If you run this code in an environment that can handle interactive graphics, like RStudio or a Jupyter notebook, or if you knit it to an html (like with this webpage!) you’ll be able to move around with your cursor and interact with it in real time. You can even embed your graphics in a responsive web environment!</p>
<p>If you wish to perform data exploration, or present your data, I recommend creating a <code>ggplot</code> plot and compiling it with <code>plotly</code>.</p>
</div>
<div id="ggvis" class="section level3 hasAnchor" number="5.3.2">
<h3><span class="header-section-number">5.3.2</span> ggvis<a href="web-app.html#ggvis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now we’re going to look at another package, <code>ggvis</code>, which you’ll notice has the same graph building philosophy, albeit with a slightly different syntax. Install the package and then load it.</p>
<div class="sourceCode" id="cb575"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb575-1"><a href="web-app.html#cb575-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;ggvis&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb576"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb576-1"><a href="web-app.html#cb576-1" tabindex="-1"></a><span class="fu">library</span>(ggvis)</span></code></pre></div>
<p>We’re going to practice some of the basics of <code>ggvis</code> with a demo dataset that can be found in the R base package.</p>
<div class="sourceCode" id="cb577"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb577-1"><a href="web-app.html#cb577-1" tabindex="-1"></a><span class="co"># first layer is the points of a scatter plot</span></span>
<span id="cb577-2"><a href="web-app.html#cb577-2" tabindex="-1"></a><span class="co"># second layer is a simple linear model, </span></span>
<span id="cb577-3"><a href="web-app.html#cb577-3" tabindex="-1"></a><span class="co"># SE=TRUE displays confidence bans around the predictions</span></span>
<span id="cb577-4"><a href="web-app.html#cb577-4" tabindex="-1"></a>mtcars <span class="sc">%&gt;%</span> </span>
<span id="cb577-5"><a href="web-app.html#cb577-5" tabindex="-1"></a>    <span class="fu">ggvis</span>(<span class="sc">~</span>hp, <span class="sc">~</span>mpg, <span class="at">fill :=</span> <span class="st">&quot;red&quot;</span>, <span class="at">stroke :=</span> <span class="st">&quot;black&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb577-6"><a href="web-app.html#cb577-6" tabindex="-1"></a>    <span class="fu">layer_points</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb577-7"><a href="web-app.html#cb577-7" tabindex="-1"></a>    <span class="fu">layer_model_predictions</span>(<span class="at">model =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) </span></code></pre></div>
<pre><code>## Guessing formula = mpg ~ hp</code></pre>
<div id="plot_id400232867-container" class="ggvis-output-container">
<div id="plot_id400232867" class="ggvis-output"></div>
<div class="plot-gear-icon">
<nav class="ggvis-control">
<a class="ggvis-dropdown-toggle" title="Controls" onclick="return false;"></a>
<ul class="ggvis-dropdown">
<li>
Renderer: 
<a id="plot_id400232867_renderer_svg" class="ggvis-renderer-button" onclick="return false;" data-plot-id="plot_id400232867" data-renderer="svg">SVG</a>
 | 
<a id="plot_id400232867_renderer_canvas" class="ggvis-renderer-button" onclick="return false;" data-plot-id="plot_id400232867" data-renderer="canvas">Canvas</a>
</li>
<li>
<a id="plot_id400232867_download" class="ggvis-download" data-plot-id="plot_id400232867">Download</a>
</li>
</ul>
</nav>
</div>
</div>
<script type="text/javascript">
var plot_id400232867_spec = {
  "data": [
    {
      "name": ".0",
      "format": {
        "type": "csv",
        "parse": {
          "hp": "number",
          "mpg": "number"
        }
      },
      "values": "\"hp\",\"mpg\"\n110,21\n110,21\n93,22.8\n110,21.4\n175,18.7\n105,18.1\n245,14.3\n62,24.4\n95,22.8\n123,19.2\n123,17.8\n180,16.4\n180,17.3\n180,15.2\n205,10.4\n215,10.4\n230,14.7\n66,32.4\n52,30.4\n65,33.9\n97,21.5\n150,15.5\n150,15.2\n245,13.3\n175,19.2\n66,27.3\n91,26\n113,30.4\n264,15.8\n175,19.7\n335,15\n109,21.4"
    },
    {
      "name": ".0/model_prediction1",
      "format": {
        "type": "csv",
        "parse": {
          "resp_upr_": "number",
          "pred_": "number",
          "resp_lwr_": "number",
          "resp_": "number"
        }
      },
      "values": "\"resp_upr_\",\"pred_\",\"resp_lwr_\",\"resp_\"\n28.9539561667808,52,24.1480239930215,26.5509900799012\n28.6496491775942,55.5822784810127,23.9635055975436,26.3065773875689\n28.3461713713736,59.1645569620253,23.7781580190995,26.0621646952366\n28.0435887590415,62.746835443038,23.591915246767,25.8177520029042\n27.7419733779546,66.3291139240506,23.4047052431893,25.5733393105719\n27.4414038030538,69.9113924050633,23.2164494334254,25.3289266182396\n27.1419656700355,73.493670886076,23.0270621817791,25.0845139259073\n26.8437521980344,77.0759493670886,22.8364502691156,24.840101233575\n26.5468646942973,80.6582278481013,22.644512388188,24.5956885412427\n26.251413017124,84.2405063291139,22.4511386806968,24.3512758489104\n25.9575159659163,87.8227848101266,22.2562103472398,24.1068631565781\n25.6653015585694,91.4050632911392,22.0595993699221,23.8624504642458\n25.3749071469108,94.9873417721519,21.8611683969161,23.6180377719135\n25.0864793110353,98.5696202531646,21.6607708481269,23.3736250795811\n24.8001734641519,102.151898734177,21.4582513103458,23.1292123872488\n24.5161530924815,105.73417721519,21.2534462973516,22.8847996949165\n24.234588551911,109.316455696203,21.0461854532575,22.6403870025842\n23.9556553471669,112.898734177215,20.8362932733369,22.3959743102519\n23.6795318332236,116.481012658228,20.6235914026156,22.1515616179196\n23.406396305344,120.06329113924,20.4079015458306,21.9071489255873\n23.1364234855123,123.645569620253,20.1890489809976,21.662736233255\n22.8697804690234,127.227848101266,19.9668666128219,21.4183235409227\n22.6066222625552,130.810126582278,19.7411994346255,21.1739108485903\n22.3470871172004,134.392405063291,19.5119091953157,20.929498156258\n22.0912919258557,137.974683544304,19.2788790019957,20.6850854639257\n21.8393280006864,141.556962025316,19.0420175425005,20.4406727715934\n21.5912575599297,145.139240506329,18.8012625985925,20.1962600792611\n21.3471112247681,148.721518987342,18.5565835490895,19.9518473869288\n21.1068867545826,152.303797468354,18.3079826346104,19.7074346945965\n20.870549140235,155.886075949367,18.0554948642934,19.4630220022642\n20.6380320464542,159.46835443038,17.7991865734096,19.2186093099319\n20.4092404673463,163.050632911392,17.5391527678528,18.9741966175996\n20.1840543545007,166.632911392405,17.2755134960338,18.7297839252672\n19.9623329104666,170.215189873418,17.0084095554033,18.4853712329349\n19.7439192178523,173.79746835443,16.7379978633529,18.2409585406026\n19.5286448929564,177.379746835443,16.4644468035843,17.9965458482703\n19.3163345026336,180.962025316456,16.1879318092424,17.752133155938\n19.1068095506137,184.544303797468,15.9086313765977,17.5077204636057\n18.8998919115727,188.126582278481,15.6267236309741,17.2633077712734\n18.6954066575702,191.708860759494,15.3423835003119,17.0188950789411\n18.4931842755888,195.291139240506,15.0557804976288,16.7744823866088\n18.293062314226,198.873417721519,14.7670770743269,16.5300696942765\n18.0948865224078,202.455696202532,14.4764274814805,16.2856570019441\n17.8985115554182,206.037974683544,14.1839770638055,16.0412443096118\n17.7038013264989,209.620253164557,13.8898619080601,15.7968316172795\n17.510629078716,213.20253164557,13.5942087711785,15.5524189249472\n17.3188772443094,216.784810126582,13.2971352209205,15.3080062326149\n17.1284371493558,220.367088607595,12.9987499312094,15.0635935402826\n16.939208611706,223.949367088608,12.6991530841945,14.8191808479503\n16.7510994707369,227.53164556962,12.398436840499,14.574768155618\n16.5640250789958,231.113924050633,12.0966858475755,14.3303554632857\n16.377907778547,234.696202531646,11.7939777633597,14.0859427709534\n16.1926763787963,238.278481012658,11.4903837784458,13.841530078621\n16.0082656477047,241.860759493671,11.1859691248727,13.5971173862887\n15.8246158244662,245.443037974684,10.8807935634466,13.3527046939564\n15.6416721587767,249.025316455696,10.5749118444715,13.1082920016241\n15.4593844795965,252.607594936709,10.2683741389871,12.8638793092918\n15.2777067946728,256.189873417722,9.96122643924618,12.6194666169595\n15.0965969209158,259.772151898734,9.65351092833856,12.3750539246272\n14.9160161449042,263.354430379747,9.34526631968554,12.1306412322949\n14.7359289122555,266.93670886076,9.03652816766962,11.8862285399626\n14.5563025442558,270.518987341772,8.72732915100475,11.6418158476303\n14.3771069799548,274.101265822785,8.41769933064106,11.3974031552979\n14.1983145418528,277.683544303797,8.10766638407845,11.1529904629656\n14.0198997232979,281.26582278481,7.79725581796873,10.9085777706333\n13.8418389957637,284.848101265823,7.48649116083834,10.664165078301\n13.6641106342545,288.430379746835,7.17539413768294,10.4197523859687\n13.4866945591898,292.012658227848,6.86398482808294,10.1753396936364\n13.3095721932318,295.594936708861,6.55228180937632,9.93092700130408\n13.1327263316361,299.177215189873,6.24030228630747,9.68651430897176\n12.9561410248252,302.759493670886,5.92806220845368,9.44210161663946\n12.779801471997,306.341772151899,5.61557637661734,9.19768892430715\n12.6036939246859,309.924050632911,5.30285853926373,8.95327623197483\n12.4278055993024,313.506329113924,4.98992147998267,8.70886353964253\n12.2521245977622,317.088607594937,4.67677709685819,8.46445084731021\n12.076639835412,320.670886075949,4.36343647454384,8.22003815497791\n11.9013409755296,324.253164556962,4.04990994976163,7.9756254626456\n11.7262183697557,327.835443037975,3.73620717087089,7.73121277031328\n11.5512630038744,331.417721518987,3.4223371520876,7.48680007798098\n11.3764664484213,335,3.10830832287606,7.24238738564866"
    },
    {
      "name": "scale/x",
      "format": {
        "type": "csv",
        "parse": {
          "domain": "number"
        }
      },
      "values": "\"domain\"\n37.85\n349.15"
    },
    {
      "name": "scale/y",
      "format": {
        "type": "csv",
        "parse": {
          "domain": "number"
        }
      },
      "values": "\"domain\"\n1.56872373901987\n35.4395845838562"
    }
  ],
  "scales": [
    {
      "name": "x",
      "domain": {
        "data": "scale/x",
        "field": "data.domain"
      },
      "zero": false,
      "nice": false,
      "clamp": false,
      "range": "width"
    },
    {
      "name": "y",
      "domain": {
        "data": "scale/y",
        "field": "data.domain"
      },
      "zero": false,
      "nice": false,
      "clamp": false,
      "range": "height"
    }
  ],
  "marks": [
    {
      "type": "symbol",
      "properties": {
        "update": {
          "size": {
            "value": 50
          },
          "fill": {
            "value": "red"
          },
          "stroke": {
            "value": "black"
          },
          "x": {
            "scale": "x",
            "field": "data.hp"
          },
          "y": {
            "scale": "y",
            "field": "data.mpg"
          }
        },
        "ggvis": {
          "data": {
            "value": ".0"
          }
        }
      },
      "from": {
        "data": ".0"
      }
    },
    {
      "type": "area",
      "properties": {
        "update": {
          "fill": {
            "value": "red"
          },
          "y2": {
            "scale": "y",
            "field": "data.resp_upr_"
          },
          "fillOpacity": {
            "value": 0.2
          },
          "x": {
            "scale": "x",
            "field": "data.pred_"
          },
          "y": {
            "scale": "y",
            "field": "data.resp_lwr_"
          },
          "stroke": {
            "value": "transparent"
          }
        },
        "ggvis": {
          "data": {
            "value": ".0/model_prediction1"
          }
        }
      },
      "from": {
        "data": ".0/model_prediction1"
      }
    },
    {
      "type": "line",
      "properties": {
        "update": {
          "stroke": {
            "value": "black"
          },
          "strokeWidth": {
            "value": 2
          },
          "x": {
            "scale": "x",
            "field": "data.pred_"
          },
          "y": {
            "scale": "y",
            "field": "data.resp_"
          },
          "fill": {
            "value": "transparent"
          }
        },
        "ggvis": {
          "data": {
            "value": ".0/model_prediction1"
          }
        }
      },
      "from": {
        "data": ".0/model_prediction1"
      }
    }
  ],
  "legends": [],
  "axes": [
    {
      "type": "x",
      "scale": "x",
      "orient": "bottom",
      "layer": "back",
      "grid": true,
      "title": "hp"
    },
    {
      "type": "y",
      "scale": "y",
      "orient": "left",
      "layer": "back",
      "grid": true,
      "title": "mpg"
    }
  ],
  "padding": null,
  "ggvis_opts": {
    "keep_aspect": false,
    "resizable": true,
    "padding": {},
    "duration": 250,
    "renderer": "svg",
    "hover_duration": 0,
    "width": "50%",
    "height": 480
  },
  "handlers": null
};
ggvis.getPlot("plot_id400232867").parseSpec(plot_id400232867_spec);
</script>
<p>This plot can be broken down into smaller components in the same as <code>ggplot</code> graphics are built-up from smaller components. In addition to what we had above, we’re plotting the data and overlaying a straight line, which is the prediction from a linear model that we’ve fitted to the data. We have also added pointwise 95% confidence interval bands to our linear model.</p>
<p>Horsepower is related to the number of cylinders in the engine. So let’s group the data into number of cylinders and then, treating each group independently, fit a new linear model. Therefore, we are fitting a piecewise linear model.</p>
<div class="sourceCode" id="cb579"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb579-1"><a href="web-app.html#cb579-1" tabindex="-1"></a><span class="do">## piecewise linear</span></span>
<span id="cb579-2"><a href="web-app.html#cb579-2" tabindex="-1"></a>mtcars <span class="sc">%&gt;%</span> </span>
<span id="cb579-3"><a href="web-app.html#cb579-3" tabindex="-1"></a>    <span class="fu">ggvis</span>(<span class="sc">~</span>wt, <span class="sc">~</span>mpg, <span class="at">fill =</span> <span class="sc">~</span><span class="fu">factor</span>(cyl)) <span class="sc">%&gt;%</span> </span>
<span id="cb579-4"><a href="web-app.html#cb579-4" tabindex="-1"></a>    <span class="fu">layer_points</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb579-5"><a href="web-app.html#cb579-5" tabindex="-1"></a>    <span class="fu">group_by</span>(cyl) <span class="sc">%&gt;%</span> </span>
<span id="cb579-6"><a href="web-app.html#cb579-6" tabindex="-1"></a>    <span class="fu">layer_model_predictions</span>(<span class="at">model =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Guessing formula = mpg ~ wt</code></pre>
<div id="plot_id241246402-container" class="ggvis-output-container">
<div id="plot_id241246402" class="ggvis-output"></div>
<div class="plot-gear-icon">
<nav class="ggvis-control">
<a class="ggvis-dropdown-toggle" title="Controls" onclick="return false;"></a>
<ul class="ggvis-dropdown">
<li>
Renderer: 
<a id="plot_id241246402_renderer_svg" class="ggvis-renderer-button" onclick="return false;" data-plot-id="plot_id241246402" data-renderer="svg">SVG</a>
 | 
<a id="plot_id241246402_renderer_canvas" class="ggvis-renderer-button" onclick="return false;" data-plot-id="plot_id241246402" data-renderer="canvas">Canvas</a>
</li>
<li>
<a id="plot_id241246402_download" class="ggvis-download" data-plot-id="plot_id241246402">Download</a>
</li>
</ul>
</nav>
</div>
</div>
<script type="text/javascript">
var plot_id241246402_spec = {
  "data": [
    {
      "name": ".0",
      "format": {
        "type": "csv",
        "parse": {
          "wt": "number",
          "mpg": "number"
        }
      },
      "values": "\"factor(cyl)\",\"wt\",\"mpg\"\n\"6\",2.62,21\n\"6\",2.875,21\n\"4\",2.32,22.8\n\"6\",3.215,21.4\n\"8\",3.44,18.7\n\"6\",3.46,18.1\n\"8\",3.57,14.3\n\"4\",3.19,24.4\n\"4\",3.15,22.8\n\"6\",3.44,19.2\n\"6\",3.44,17.8\n\"8\",4.07,16.4\n\"8\",3.73,17.3\n\"8\",3.78,15.2\n\"8\",5.25,10.4\n\"8\",5.424,10.4\n\"8\",5.345,14.7\n\"4\",2.2,32.4\n\"4\",1.615,30.4\n\"4\",1.835,33.9\n\"4\",2.465,21.5\n\"8\",3.52,15.5\n\"8\",3.435,15.2\n\"8\",3.84,13.3\n\"8\",3.845,19.2\n\"4\",1.935,27.3\n\"4\",2.14,26\n\"4\",1.513,30.4\n\"8\",3.17,15.8\n\"6\",2.77,19.7\n\"8\",3.57,15\n\"4\",2.78,21.4"
    },
    {
      "name": ".0/group_by1/model_prediction2_flat",
      "format": {
        "type": "csv",
        "parse": {
          "cyl": "number",
          "resp_upr_": "number",
          "pred_": "number",
          "resp_lwr_": "number",
          "resp_": "number"
        }
      },
      "values": "\"cyl\",\"factor(cyl)\",\"resp_upr_\",\"pred_\",\"resp_lwr_\",\"resp_\"\n4,\"4\",34.9800883018005,1.513,27.0744052837557,31.0272467927781\n4,\"4\",34.7878615744043,1.53422784810127,27.0268836222127,30.9073725983085\n4,\"4\",34.5963328605434,1.55545569620253,26.9786639471342,30.7874984038388\n4,\"4\",34.4055423024242,1.5766835443038,26.9297061163141,30.6676242093691\n4,\"4\",34.2155327168905,1.59791139240506,26.8799673129085,30.5477500148995\n4,\"4\",34.0263497684374,1.61913924050633,26.8294018724222,30.4278758204298\n4,\"4\",33.8380421479348,1.6403670886076,26.7779611039855,30.3080016259602\n4,\"4\",33.6506617556389,1.66159493670886,26.7255931073421,30.1881274314905\n4,\"4\",33.4642638865708,1.68282278481013,26.6722425874709,30.0682532370208\n4,\"4\",33.278907415743,1.70405063291139,26.6178506693593,29.9483790425512\n4,\"4\",33.094654980002,1.72527848101266,26.562354716161,29.8285048480815\n4,\"4\",32.9115731524215,1.74650632911392,26.5056881548022,29.7086306536118\n4,\"4\",32.7297326042198,1.76773417721519,26.4477803140646,29.5887564591422\n4,\"4\",32.5492082480776,1.78896202531646,26.3885562812674,29.4688822646725\n4,\"4\",32.3700793555192,1.81018987341772,26.3279367848865,29.3490080702029\n4,\"4\",32.1924296396951,1.83141772151899,26.2658381117713,29.2291338757332\n4,\"4\",32.016347293513,1.85264556962025,26.2021720690141,29.1092596812635\n4,\"4\",31.8419249716569,1.87387341772152,26.1368460019308,28.9893854867939\n4,\"4\",31.6692597036891,1.89510126582278,26.0697628809594,28.8695112923242\n4,\"4\",31.4984527242664,1.91632911392405,26.0008214714427,28.7496370978545\n4,\"4\",31.3296092056584,1.93755696202532,25.9299166011113,28.6297629033849\n4,\"4\",31.1628378774112,1.95878481012658,25.8569395404193,28.5098887089152\n4,\"4\",30.9982505183714,1.98001265822785,25.7817785105198,28.3900145144456\n4,\"4\",30.8359613076045,2.00124050632911,25.7043193323473,28.2701403199759\n4,\"4\",30.6760860232353,2.02246835443038,25.6244462277772,28.1502661255062\n4,\"4\",30.5187410821409,2.04369620253165,25.5420427799323,28.0303919310366\n4,\"4\",30.3640424188694,2.06492405063291,25.4569930542644,27.9105177365669\n4,\"4\",30.2121042092076,2.08615189873418,25.3691828749869,27.7906435420973\n4,\"4\",30.0630374523529,2.10737974683544,25.2785012429023,27.6707693476276\n4,\"4\",29.916948435364,2.12860759493671,25.1848418709519,27.5508951531579\n4,\"4\",29.7739371139142,2.14983544303797,25.0881048034624,27.4310209586883\n4,\"4\",29.6340954535847,2.17106329113924,24.9881980748525,27.3111467642186\n4,\"4\",29.49750578503,2.19229113924051,24.8850393544679,27.1912725697489\n4,\"4\",29.3642392332396,2.21351898734177,24.778557517319,27.0713983752793\n4,\"4\",29.2343542847436,2.23474683544304,24.6686940768756,26.9515241808096\n4,\"4\",29.1078955560778,2.2559746835443,24.5554044166022,26.83164998634\n4,\"4\",28.9848928216124,2.27720253164557,24.4386587621282,26.7117757918703\n4,\"4\",28.8653603489254,2.29843037974684,24.3184428458759,26.5919015974006\n4,\"4\",28.7492965757988,2.3196582278481,24.1947582300632,26.472027402931\n4,\"4\",28.6366841457288,2.34088607594937,24.0676222711938,26.3521532084613\n4,\"4\",28.5274903000826,2.36211392405063,23.9370677279007,26.2322790139917\n4,\"4\",28.4216676064509,2.3833417721519,23.8031420325931,26.112404819522\n4,\"4\",28.3191549860566,2.40456962025316,23.665906264048,25.9925306250523\n4,\"4\",28.2198789897303,2.42579746835443,23.5254338714351,25.8726564305827\n4,\"4\",28.1237552629424,2.4470253164557,23.3818092092836,25.752782236113\n4,\"4\",28.0306901361137,2.46825316455696,23.235125947173,25.6329080416433\n4,\"4\",27.940582276763,2.48948101265823,23.0854854175844,25.5130338471737\n4,\"4\",27.8533243444002,2.51070886075949,22.9329949610078,25.393159652704\n4,\"4\",27.7688045964828,2.53193670886076,22.7777663199859,25.2732854582344\n4,\"4\",27.686908403153,2.55316455696203,22.6199141243764,25.1534112637647\n4,\"4\",27.6075196387857,2.57439240506329,22.4595544998043,25.033537069295\n4,\"4\",27.5305219286576,2.59562025316456,22.2968038209932,24.9136628748254\n4,\"4\",27.455799738566,2.61684810126582,22.1317776221454,24.7937886803557\n4,\"4\",27.3832393034878,2.63807594936709,21.9645896682843,24.673914485886\n4,\"4\",27.312729398101,2.65930379746835,21.7953511847317,24.5540402914164\n4,\"4\",27.2441619571281,2.68053164556962,21.6241702367653,24.4341660969467\n4,\"4\",27.1774325570663,2.70175949367089,21.4511512478878,24.3142919024771\n4,\"4\",27.1124407731176,2.72298734177215,21.2763946428972,24.1944177080074\n4,\"4\",27.0490904262451,2.74421518987342,21.0999966008303,24.0745435135377\n4,\"4\",26.9872897354914,2.76544303797468,20.9220489026447,23.9546693190681\n4,\"4\",26.9269513902401,2.78667088607595,20.7426388589567,23.8347951245984\n4,\"4\",26.8679925561809,2.80789873417721,20.5618493040766,23.7149209301288\n4,\"4\",26.8103348275276,2.82912658227848,20.3797586437906,23.5950467356591\n4,\"4\",26.7539041366752,2.85035443037975,20.1964409457036,23.4751725411894\n4,\"4\",26.6986306310718,2.87158227848101,20.0119660623677,23.3552983467198\n4,\"4\",26.6444485256997,2.89281012658228,19.8263997788006,23.2354241522501\n4,\"4\",26.5912959382549,2.91403797468354,19.639803977306,23.1155499577804\n4,\"4\",26.5391147129223,2.93526582278481,19.4522368136993,22.9956757633108\n4,\"4\",26.4878502375736,2.95649367088608,19.2637529001086,22.8758015688411\n4,\"4\",26.43745125828,2.97772151898734,19.0744034904629,22.7559273743715\n4,\"4\",26.3878696942205,2.99894936708861,18.8842366655831,22.6360531799018\n4,\"4\",26.3390604553797,3.02017721518987,18.6932975154845,22.5161789854321\n4,\"4\",26.2909812648498,3.04140506329114,18.5016283170751,22.3963047909625\n4,\"4\",26.2435924870719,3.0626329113924,18.3092687059137,22.2764305964928\n4,\"4\",26.1968569629596,3.08386075949367,18.1162558410868,22.1565564020232\n4,\"4\",26.1507398525278,3.10508860759494,17.9226245625792,22.0366822075535\n4,\"4\",26.1052084853965,3.1263164556962,17.7284075407712,21.9168080130838\n4,\"4\",26.0602322193357,3.14754430379747,17.5336354178926,21.7969338186142\n4,\"4\",26.0157823068645,3.16877215189873,17.3383369414245,21.6770596241445\n4,\"4\",25.9718317697946,3.19,17.1425390895551,21.5571854296748\n6,\"6\",23.1723845745727,2.62,19.0775493306446,21.1249669526086\n6,\"6\",23.1125231041877,2.6306329113924,19.0782895608044,21.0954063324961\n6,\"6\",23.0528695730455,2.64126582278481,19.0788218517216,21.0658457123835\n6,\"6\",22.993433572926,2.65189873417722,19.0791366116161,21.036285092271\n6,\"6\",22.9342252187496,2.66253164556962,19.0792237255673,21.0067244721585\n6,\"6\",22.8752551778727,2.67316455696203,19.0790725262192,20.9771638520459\n6,\"6\",22.8165347005907,2.68379746835443,19.0786717632761,20.9476032319334\n6,\"6\",22.7580756517921,2.69443037974684,19.0780095718497,20.9180426118209\n6,\"6\",22.699890543671,2.70506329113924,19.0770734397456,20.8884819917083\n6,\"6\",22.6419925693754,2.71569620253165,19.0758501738162,20.8589213715958\n6,\"6\",22.5843956374238,2.72632911392405,19.0743258655427,20.8293607514833\n6,\"6\",22.5271144066764,2.73696202531646,19.072485856065,20.7998001313707\n6,\"6\",22.4701643215869,2.74759493670886,19.0703147009294,20.7702395112582\n6,\"6\",22.4135616473952,2.75822784810127,19.067796134896,20.7406788911456\n6,\"6\",22.3573235048459,2.76886075949367,19.0649130372203,20.7111182710331\n6,\"6\",22.3014679039278,2.77949367088608,19.0616473979134,20.6815576509206\n6,\"6\",22.2460137760314,2.79012658227848,19.0579802855846,20.651997030808\n6,\"6\",22.1909810038126,2.80075949367089,19.0538918175784,20.6224364106955\n6,\"6\",22.1363904479253,2.81139240506329,19.0493611332406,20.592875790583\n6,\"6\",22.0822639696583,2.8220253164557,19.0443663712825,20.5633151704704\n6,\"6\",22.0286244483649,2.8326582278481,19.0388846523509,20.5337545503579\n6,\"6\",21.9754957924307,2.84329113924051,19.03289206806,20.5041939302453\n6,\"6\",21.9229029423707,2.85392405063291,19.026363677895,20.4746333101328\n6,\"6\",21.870871864499,2.86455696202532,19.0192735155415,20.4450726900203\n6,\"6\",21.8194295334774,2.87518987341772,19.0115946063381,20.4155120699077\n6,\"6\",21.7686039019237,2.88582278481013,19.0032989976667,20.3859514497952\n6,\"6\",21.7184238551734,2.89645569620253,18.9943578041919,20.3563908296827\n6,\"6\",21.6689191492339,2.90708860759494,18.9847412699063,20.3268302095701\n6,\"6\",21.6201203299789,2.91772151898734,18.9744188489363,20.2972695894576\n6,\"6\",21.5720586317122,2.92835443037975,18.9633593069779,20.267708969345\n6,\"6\",21.5247658533985,2.93898734177215,18.9515308450665,20.2381483492325\n6,\"6\",21.4782742111402,2.94962025316456,18.9389012470997,20.20858772912\n6,\"6\",21.432616165881,2.96025316455696,18.9254380521338,20.1790271090074\n6,\"6\",21.3878242258559,2.97088607594937,18.9111087519339,20.1494664888949\n6,\"6\",21.3439307239869,2.98151898734177,18.8958810135778,20.1199058687824\n6,\"6\",21.3009675712443,2.99215189873418,18.8797229260953,20.0903452486698\n6,\"6\",21.2589659879359,3.00278481012658,18.8626032691787,20.0607846285573\n6,\"6\",21.2179562159366,3.01341772151899,18.8444918009528,20.0312240084447\n6,\"6\",21.1779672159739,3.02405063291139,18.8253595606905,20.0016633883322\n6,\"6\",21.1390263551952,3.0346835443038,18.8051791812441,19.9721027682197\n6,\"6\",21.1011590912963,3.0453164556962,18.783925204918,19.9425421481071\n6,\"6\",21.0643886603937,3.05594936708861,18.7615743955954,19.9129815279946\n6,\"6\",21.0287357765203,3.06658227848101,18.7381060392438,19.8834209078821\n6,\"6\",20.9942183510101,3.07721518987342,18.713502224529,19.8538602877695\n6,\"6\",20.9608512400729,3.08784810126582,18.687748095241,19.824299667657\n6,\"6\",20.9286460284799,3.09848101265823,18.660832066609,19.7947390475444\n6,\"6\",20.8976108564787,3.10911392405063,18.6327459983851,19.7651784274319\n6,\"6\",20.8677502958511,3.11974683544304,18.6034853187876,19.7356178073194\n6,\"6\",20.8390652794599,3.13037974683544,18.5730490949538,19.7060571872068\n6,\"6\",20.8115530867982,3.14101265822785,18.5414400473904,19.6764965670943\n6,\"6\",20.785207386061,3.15164556962025,18.5086645079025,19.6469359469818\n6,\"6\",20.7600183312298,3.16227848101266,18.4747323225087,19.6173753268692\n6,\"6\",20.7359727107328,3.17291139240506,18.4396567027806,19.5878147067567\n6,\"6\",20.7130541425258,3.18354430379747,18.4034540307625,19.5582540866442\n6,\"6\",20.6912433090431,3.19417721518987,18.3661436240201,19.5286934665316\n6,\"6\",20.6705182244534,3.20481012658228,18.3277474683848,19.4991328464191\n6,\"6\",20.6508545260602,3.21544303797468,18.2882899265529,19.4695722263065\n6,\"6\",20.6322257815163,3.22607594936709,18.2477974308717,19.440011606194\n6,\"6\",20.6146038037327,3.23670886075949,18.2062981684303,19.4104509860815\n6,\"6\",20.5979589659109,3.2473417721519,18.163821766027,19.3808903659689\n6,\"6\",20.5822605099377,3.2579746835443,18.1203989817751,19.3513297458564\n6,\"6\",20.5674768423645,3.26860759493671,18.0760614091232,19.3217691257439\n6,\"6\",20.5535758132878,3.27924050632911,18.0308411979748,19.2922085056313\n6,\"6\",20.5405249745576,3.28987341772152,17.9847707964799,19.2626478855188\n6,\"6\",20.5282918148291,3.30050632911392,17.9378827159833,19.2330872654062\n6,\"6\",20.5168439699684,3.31113924050633,17.890209320619,19.2035266452937\n6,\"6\",20.5061494082127,3.32177215189873,17.8417826421496,19.1739660251812\n6,\"6\",20.4961765902363,3.33240506329114,17.792634219901,19.1444054050686\n6,\"6\",20.4868946048837,3.34303797468354,17.7427949650285,19.1148447849561\n6,\"6\",20.4782732818028,3.35367088607595,17.6922950478843,19.0852841648436\n6,\"6\",20.4702832825505,3.36430379746835,17.6411638069116,19.055723544731\n6,\"6\",20.462896171969,3.37493670886076,17.589429677268,19.0261629246185\n6,\"6\",20.4560844717538,3.38556962025316,17.5371201372581,18.9966023045059\n6,\"6\",20.4498216981771,3.39620253164557,17.4842616706097,18.9670416843934\n6,\"6\",20.4440823859077,3.40683544303797,17.430879742654,18.9374810642809\n6,\"6\",20.4388420997957,3.41746835443038,17.376998788541,18.9079204441683\n6,\"6\",20.4340774363812,3.42810126582278,17.3226422117304,18.8783598240558\n6,\"6\",20.4297660167573,3.43873417721519,17.2678323911292,18.8487992039433\n6,\"6\",20.4258864722709,3.44936708860759,17.2125906953905,18.8192385838307\n6,\"6\",20.4224184243942,3.46,17.1569375030421,18.7896779637182\n8,\"8\",18.6992958991983,3.17,15.1367057991096,16.9180008491539\n8,\"8\",18.6025504459053,3.19853164556962,15.1083435287008,16.8554469873031\n8,\"8\",18.5063553048496,3.22706329113924,15.0794309460548,16.7928931254522\n8,\"8\",18.4107435277022,3.25559493670886,15.0499349995005,16.7303392636013\n8,\"8\",18.315750221402,3.28412658227848,15.019820582099,16.6677854017505\n8,\"8\",18.221412627596,3.3126582278481,14.9890504522032,16.6052315398996\n8,\"8\",18.1277701911419,3.34118987341772,14.9575851649556,16.5426776780488\n8,\"8\",18.0348646136681,3.36972151898734,14.9253830187278,16.4801238161979\n8,\"8\",17.9427398874988,3.39825316455696,14.8924000211953,16.4175699543471\n8,\"8\",17.851442304536,3.42678481012658,14.8585898804564,16.3550160924962\n8,\"8\",17.761020433982,3.4553164556962,14.8239040273087,16.2924622306453\n8,\"8\",17.6715250621331,3.48384810126582,14.7882916754559,16.2299083687945\n8,\"8\",17.5830090869368,3.51237974683544,14.7516999269504,16.1673545069436\n8,\"8\",17.495527359662,3.54091139240506,14.7140739305235,16.1048006450928\n8,\"8\",17.4091364659871,3.56944303797468,14.6753571004967,16.0422467832419\n8,\"8\",17.3238944391672,3.5979746835443,14.6354914036149,15.9796929213911\n8,\"8\",17.2398603988275,3.62650632911392,14.5944177202529,15.9171390595402\n8,\"8\",17.1570941104565,3.65503797468354,14.5520762849222,15.8545851976894\n8,\"8\",17.0756554629441,3.68356962025316,14.5084072087328,15.7920313358385\n8,\"8\",16.9956038645804,3.71210126582278,14.4633510833949,15.7294774739876\n8,\"8\",16.9169975618057,3.7406329113924,14.4168496624679,15.6669236121368\n8,\"8\",16.8398928895852,3.76916455696203,14.3688466109867,15.6043697502859\n8,\"8\",16.7643434673734,3.79769620253165,14.3192883094967,15.5418158884351\n8,\"8\",16.6903993599216,3.82622784810127,14.2681246932468,15.4792620265842\n8,\"8\",16.6181062272256,3.85475949367089,14.2153101022411,15.4167081647334\n8,\"8\",16.5475044921959,3.88329113924051,14.160804113569,15.3541543028825\n8,\"8\",16.4786285576011,3.91182278481013,14.1045723244621,15.2916004410316\n8,\"8\",16.4115061049729,3.94035443037975,14.0465870533887,15.2290465791808\n8,\"8\",16.3461575070749,3.96888607594937,13.9868279275849,15.1664927173299\n8,\"8\",16.2825953820421,3.99741772151899,13.9252823289161,15.1039388554791\n8,\"8\",16.2208243114707,4.02594936708861,13.8619456757857,15.0413849936282\n8,\"8\",16.1608407369642,4.05448101265823,13.7968215265906,14.9788311317774\n8,\"8\",16.1026330405336,4.08301265822785,13.7299214993194,14.9162772699265\n8,\"8\",16.0461818046536,4.11154430379747,13.6612650114977,14.8537234080756\n8,\"8\",15.9914602385588,4.14007594936709,13.5908788538908,14.7911695462248\n8,\"8\",15.9384347493815,4.16860759493671,13.5187966193663,14.7286156843739\n8,\"8\",15.8870656306358,4.19713924050633,13.4450580144103,14.6660618225231\n8,\"8\",15.8373078367516,4.22567088607595,13.3697080845928,14.6035079606722\n8,\"8\",15.7891118109792,4.25420253164557,13.2927963866635,14.5409540988214\n8,\"8\",15.7424243348589,4.28273417721519,13.2143761390822,14.4784002369705\n8,\"8\",15.6971893702164,4.31126582278481,13.1345033800229,14.4158463751197\n8,\"8\",15.6533488687944,4.33979746835443,13.0532361577432,14.3532925132688\n8,\"8\",15.6108435296072,4.36832911392405,12.9706337732286,14.2907386514179\n8,\"8\",15.5696134893919,4.39686075949367,12.8867560897423,14.2281847895671\n8,\"8\",15.5295989366614,4.42539240506329,12.801662918771,14.1656309277162\n8,\"8\",15.4907406445313,4.45392405063291,12.7154134871994,14.1030770658654\n8,\"8\",15.4529804214564,4.48245569620253,12.6280659865726,14.0405232040145\n8,\"8\",15.4162614821927,4.51098734177215,12.5396772021346,13.9779693421637\n8,\"8\",15.3805287436658,4.53951898734177,12.4503022169598,13.9154154803128\n8,\"8\",15.3457290520454,4.56805063291139,12.3599941848785,13.8528616184619\n8,\"8\",15.3118113482838,4.59658227848101,12.2688041649384,13.7903077566111\n8,\"8\",15.2787267797939,4.62511392405063,12.1767810097265,13.7277538947602\n8,\"8\",15.2464287659408,4.65364556962025,12.0839712998779,13.6652000329094\n8,\"8\",15.2148730247105,4.68217721518987,11.9904193174065,13.6026461710585\n8,\"8\",15.1840175674012,4.71070886075949,11.8961670510141,13.5400923092077\n8,\"8\",15.1538226675399,4.73924050632911,11.8012542271737,13.4775384473568\n8,\"8\",15.1242508095215,4.76777215189873,11.7057183614904,13.4149845855059\n8,\"8\",15.0952666217545,4.79630379746835,11.6095948255557,13.3524307236551\n8,\"8\",15.0668367983996,4.82483544303797,11.5129169252088,13.2898768618042\n8,\"8\",15.0389300131448,4.8533670886076,11.415715986762,13.2273229999534\n8,\"8\",15.0115168278645,4.88189873417722,11.3180214483406,13.1647691381025\n8,\"8\",14.9845695984917,4.91043037974684,11.2198609540116,13.1022152762517\n8,\"8\",14.9580623799677,4.93896202531646,11.1212604488339,13.0396614144008\n8,\"8\",14.9319708317432,4.96749367088608,11.0222442733567,12.97710755255\n8,\"8\",14.9062721249679,4.9960253164557,10.9228352564302,12.9145536906991\n8,\"8\",14.8809448522267,5.02455696202532,10.8230548054698,12.8519998288482\n8,\"8\",14.8559689404472,5.05308860759494,10.7229229935476,12.7894459669974\n8,\"8\",14.8313255674154,5.08162025316456,10.6224586428776,12.7268921051465\n8,\"8\",14.8069970821816,5.11015189873418,10.5216794044097,12.6643382432957\n8,\"8\",14.7829669295166,5.1386835443038,10.420601833373,12.6017843814448\n8,\"8\",14.7592195784832,5.16721518987342,10.3192414607047,12.539230519594\n8,\"8\",14.7357404551115,5.19574683544304,10.2176128603747,12.4766766577431\n8,\"8\",14.7125158791116,5.22427848101266,10.1157297126729,12.4141227958922\n8,\"8\",14.6895330045135,5.25281012658228,10.0136048635692,12.3515689340414\n8,\"8\",14.6667797640944,5.2813417721519,9.91125038028669,12.2890150721905\n8,\"8\",14.6442448174328,5.30987341772152,9.80867760324656,12.2264612103397\n8,\"8\",14.6219175024161,5.33840506329114,9.70589719456153,12.1639073484888\n8,\"8\",14.5997877900186,5.36693670886076,9.60291918325737,12.101353486638\n8,\"8\",14.5778462421665,5.39546835443038,9.49975300740769,12.0387996247871\n8,\"8\",14.5560839725069,5.424,9.3964075533656,11.9762457629362"
    },
    {
      "name": ".0/group_by1/model_prediction2",
      "source": ".0/group_by1/model_prediction2_flat",
      "transform": [
        {
          "type": "treefacet",
          "keys": [
            "data.cyl"
          ]
        }
      ]
    },
    {
      "name": "scale/fill",
      "format": {
        "type": "csv",
        "parse": {}
      },
      "values": "\"domain\"\n\"4\"\n\"6\"\n\"8\""
    },
    {
      "name": "scale/x",
      "format": {
        "type": "csv",
        "parse": {
          "domain": "number"
        }
      },
      "values": "\"domain\"\n1.31745\n5.61955"
    },
    {
      "name": "scale/y",
      "format": {
        "type": "csv",
        "parse": {
          "domain": "number"
        }
      },
      "values": "\"domain\"\n8.11722351594386\n36.2592723392223"
    }
  ],
  "scales": [
    {
      "name": "fill",
      "type": "ordinal",
      "domain": {
        "data": "scale/fill",
        "field": "data.domain"
      },
      "points": true,
      "sort": false,
      "range": "category10"
    },
    {
      "name": "x",
      "domain": {
        "data": "scale/x",
        "field": "data.domain"
      },
      "zero": false,
      "nice": false,
      "clamp": false,
      "range": "width"
    },
    {
      "name": "y",
      "domain": {
        "data": "scale/y",
        "field": "data.domain"
      },
      "zero": false,
      "nice": false,
      "clamp": false,
      "range": "height"
    }
  ],
  "marks": [
    {
      "type": "symbol",
      "properties": {
        "update": {
          "size": {
            "value": 50
          },
          "fill": {
            "scale": "fill",
            "field": "data.factor(cyl)"
          },
          "x": {
            "scale": "x",
            "field": "data.wt"
          },
          "y": {
            "scale": "y",
            "field": "data.mpg"
          }
        },
        "ggvis": {
          "data": {
            "value": ".0"
          }
        }
      },
      "from": {
        "data": ".0"
      }
    },
    {
      "type": "group",
      "from": {
        "data": ".0/group_by1/model_prediction2"
      },
      "marks": [
        {
          "type": "area",
          "properties": {
            "update": {
              "fill": {
                "scale": "fill",
                "field": "data.factor(cyl)"
              },
              "y2": {
                "scale": "y",
                "field": "data.resp_upr_"
              },
              "fillOpacity": {
                "value": 0.2
              },
              "x": {
                "scale": "x",
                "field": "data.pred_"
              },
              "y": {
                "scale": "y",
                "field": "data.resp_lwr_"
              },
              "stroke": {
                "value": "transparent"
              }
            },
            "ggvis": {
              "data": {
                "value": ".0/group_by1/model_prediction2"
              }
            }
          }
        }
      ]
    },
    {
      "type": "group",
      "from": {
        "data": ".0/group_by1/model_prediction2"
      },
      "marks": [
        {
          "type": "line",
          "properties": {
            "update": {
              "stroke": {
                "value": "#000000"
              },
              "strokeWidth": {
                "value": 2
              },
              "x": {
                "scale": "x",
                "field": "data.pred_"
              },
              "y": {
                "scale": "y",
                "field": "data.resp_"
              },
              "fill": {
                "value": "transparent"
              }
            },
            "ggvis": {
              "data": {
                "value": ".0/group_by1/model_prediction2"
              }
            }
          }
        }
      ]
    }
  ],
  "legends": [
    {
      "orient": "right",
      "fill": "fill",
      "title": "factor(cyl)"
    }
  ],
  "axes": [
    {
      "type": "x",
      "scale": "x",
      "orient": "bottom",
      "layer": "back",
      "grid": true,
      "title": "wt"
    },
    {
      "type": "y",
      "scale": "y",
      "orient": "left",
      "layer": "back",
      "grid": true,
      "title": "mpg"
    }
  ],
  "padding": null,
  "ggvis_opts": {
    "keep_aspect": false,
    "resizable": true,
    "padding": {},
    "duration": 250,
    "renderer": "svg",
    "hover_duration": 0,
    "width": "50%",
    "height": 480
  },
  "handlers": null
};
ggvis.getPlot("plot_id241246402").parseSpec(plot_id241246402_spec);
</script>
<div class="sourceCode" id="cb581"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb581-1"><a href="web-app.html#cb581-1" tabindex="-1"></a><span class="do">## the group_by(cyl) tells next layer to group by cylinder factor</span></span></code></pre></div>
<p>The plot shows three separate lines, with their corresponding 95% confidence intervals.</p>
</div>
<div id="interactiveresponsive-graphics" class="section level3 hasAnchor" number="5.3.3">
<h3><span class="header-section-number">5.3.3</span> Interactive/responsive graphics<a href="web-app.html#interactiveresponsive-graphics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You might be wondering, why should I use <code>ggvis</code> when I can use <code>ggplot</code> + <code>plotly</code>? Well, good question. They are almost en-par with features. However, one of the main advantages of <code>ggvis</code> is that you can make more sophisticated interactive graphics (they will be again viewed with a browser to achieve this) that the ones in <code>plotly</code>. This can be particularly cool if you wish to manipulate parameters of your statistical analysis and see them in real time.</p>
<p>The following code generates a basic interactive plot, when it is run alone in R/RStudio console. Read the warning to see why it is not interactive here.</p>
<div class="sourceCode" id="cb582"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb582-1"><a href="web-app.html#cb582-1" tabindex="-1"></a><span class="co"># In this plot we have:</span></span>
<span id="cb582-2"><a href="web-app.html#cb582-2" tabindex="-1"></a><span class="co"># a smoothing layer with input selection for span</span></span>
<span id="cb582-3"><a href="web-app.html#cb582-3" tabindex="-1"></a><span class="co"># and a point layer with input selection for size</span></span>
<span id="cb582-4"><a href="web-app.html#cb582-4" tabindex="-1"></a>vis0 <span class="ot">&lt;-</span> mtcars <span class="sc">%&gt;%</span> </span>
<span id="cb582-5"><a href="web-app.html#cb582-5" tabindex="-1"></a>    <span class="fu">ggvis</span>(<span class="sc">~</span>wt, <span class="sc">~</span>mpg, <span class="at">fill :=</span> <span class="st">&quot;purple&quot;</span>, <span class="at">stroke :=</span> <span class="st">&quot;black&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb582-6"><a href="web-app.html#cb582-6" tabindex="-1"></a>    <span class="fu">layer_smooths</span>(<span class="at">span =</span> <span class="fu">input_slider</span>(<span class="fl">0.5</span>, <span class="dv">1</span>, <span class="at">value =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb582-7"><a href="web-app.html#cb582-7" tabindex="-1"></a>    <span class="fu">layer_points</span>(<span class="at">size :=</span> <span class="fu">input_slider</span>(<span class="dv">100</span>, <span class="dv">1000</span>, <span class="at">value =</span> <span class="dv">100</span>))</span>
<span id="cb582-8"><a href="web-app.html#cb582-8" tabindex="-1"></a>vis0</span></code></pre></div>
<pre><code>## Warning: Can&#39;t output dynamic/interactive ggvis plots in a knitr document.
## Generating a static (non-dynamic, non-interactive) version of the plot.</code></pre>
<div id="plot_id812560195-container" class="ggvis-output-container">
<div id="plot_id812560195" class="ggvis-output"></div>
<div class="plot-gear-icon">
<nav class="ggvis-control">
<a class="ggvis-dropdown-toggle" title="Controls" onclick="return false;"></a>
<ul class="ggvis-dropdown">
<li>
Renderer: 
<a id="plot_id812560195_renderer_svg" class="ggvis-renderer-button" onclick="return false;" data-plot-id="plot_id812560195" data-renderer="svg">SVG</a>
 | 
<a id="plot_id812560195_renderer_canvas" class="ggvis-renderer-button" onclick="return false;" data-plot-id="plot_id812560195" data-renderer="canvas">Canvas</a>
</li>
<li>
<a id="plot_id812560195_download" class="ggvis-download" data-plot-id="plot_id812560195">Download</a>
</li>
</ul>
</nav>
</div>
</div>
<script type="text/javascript">
var plot_id812560195_spec = {
  "data": [
    {
      "name": ".0",
      "format": {
        "type": "csv",
        "parse": {
          "wt": "number",
          "mpg": "number",
          "reactive_137215067": "number"
        }
      },
      "values": "\"wt\",\"mpg\",\"reactive_137215067\"\n2.62,21,100\n2.875,21,100\n2.32,22.8,100\n3.215,21.4,100\n3.44,18.7,100\n3.46,18.1,100\n3.57,14.3,100\n3.19,24.4,100\n3.15,22.8,100\n3.44,19.2,100\n3.44,17.8,100\n4.07,16.4,100\n3.73,17.3,100\n3.78,15.2,100\n5.25,10.4,100\n5.424,10.4,100\n5.345,14.7,100\n2.2,32.4,100\n1.615,30.4,100\n1.835,33.9,100\n2.465,21.5,100\n3.52,15.5,100\n3.435,15.2,100\n3.84,13.3,100\n3.845,19.2,100\n1.935,27.3,100\n2.14,26,100\n1.513,30.4,100\n3.17,15.8,100\n2.77,19.7,100\n3.57,15,100\n2.78,21.4,100"
    },
    {
      "name": ".0/model_prediction1",
      "format": {
        "type": "csv",
        "parse": {
          "pred_": "number",
          "resp_": "number"
        }
      },
      "values": "\"pred_\",\"resp_\"\n1.513,32.3559076033652\n1.56250632911392,31.8753059433938\n1.61201265822785,31.4002837186303\n1.66151898734177,30.9307786143783\n1.7110253164557,30.4667283159411\n1.76053164556962,30.0080705086221\n1.81003797468354,29.5547428777247\n1.85954430379747,29.1066831085523\n1.90905063291139,28.6638288864083\n1.95855696202532,28.2261593300757\n2.00806329113924,27.7939085521993\n2.05756962025316,27.3671227416083\n2.10707594936709,26.9458006046978\n2.15658227848101,26.5299408478625\n2.20608860759494,26.1195421774975\n2.25559493670886,25.7146032999975\n2.30510126582278,25.3151229217576\n2.35460759493671,24.9210997491726\n2.40411392405063,24.5325324886374\n2.45362025316456,24.1494198465469\n2.50312658227848,23.7704013112288\n2.5526329113924,23.3930410310992\n2.60213924050633,23.0184854507692\n2.65164556962025,22.648013375053\n2.70115189873418,22.2829036087647\n2.7506582278481,21.9244349567186\n2.80016455696203,21.5738862237289\n2.84967088607595,21.2325362146096\n2.89917721518987,20.8994648774453\n2.9486835443038,20.563314278298\n2.99818987341772,20.2260322794124\n3.04769620253165,19.8921207313052\n3.09720253164557,19.5660814844932\n3.14670886075949,19.2524163894935\n3.19621518987342,18.9556272968227\n3.24572151898734,18.6776819657173\n3.29522784810127,18.4109241123963\n3.34473417721519,18.1533810871694\n3.39424050632911,17.9038917888661\n3.44374683544304,17.6613801039195\n3.49325316455696,17.4367412601373\n3.54275949367089,17.2198928657746\n3.59226582278481,16.9885817927012\n3.64177215189873,16.7560619903523\n3.69127848101266,16.5274875375278\n3.74078481012658,16.3032371340526\n3.79029113924051,16.0836894797512\n3.83979746835443,15.8692232744485\n3.88930379746835,15.6600927173047\n3.93881012658228,15.4562638006676\n3.9883164556962,15.2577332064667\n4.03782278481013,15.064498632161\n4.08732911392405,14.8765577752094\n4.13683544303798,14.6939083330709\n4.1863417721519,14.5165480032044\n4.23584810126582,14.344474483069\n4.28535443037975,14.1776854701235\n4.33486075949367,14.016178661827\n4.3843670886076,13.8599517556385\n4.43387341772152,13.7090024490167\n4.48337974683544,13.5633284394209\n4.53288607594937,13.4229274243098\n4.58239240506329,13.2877971011425\n4.63189873417722,13.157935167378\n4.68140506329114,13.0333393204751\n4.73091139240506,12.9140072578929\n4.78041772151899,12.7999366770903\n4.82992405063291,12.6911252755264\n4.87943037974684,12.58757075066\n4.92893670886076,12.4892707999501\n4.97844303797468,12.3962231208557\n5.02794936708861,12.3084254108357\n5.07745569620253,12.2258753673492\n5.12696202531646,12.148570687855\n5.17646835443038,12.0765090698122\n5.2259746835443,12.0096882106797\n5.27548101265823,11.9481058079165\n5.32498734177215,11.8917595589815\n5.37449367088608,11.8406471613337\n5.424,11.7947663124321"
    },
    {
      "name": "scale/x",
      "format": {
        "type": "csv",
        "parse": {
          "domain": "number"
        }
      },
      "values": "\"domain\"\n1.31745\n5.61955"
    },
    {
      "name": "scale/y",
      "format": {
        "type": "csv",
        "parse": {
          "domain": "number"
        }
      },
      "values": "\"domain\"\n9.225\n35.075"
    }
  ],
  "scales": [
    {
      "name": "x",
      "domain": {
        "data": "scale/x",
        "field": "data.domain"
      },
      "zero": false,
      "nice": false,
      "clamp": false,
      "range": "width"
    },
    {
      "name": "y",
      "domain": {
        "data": "scale/y",
        "field": "data.domain"
      },
      "zero": false,
      "nice": false,
      "clamp": false,
      "range": "height"
    }
  ],
  "marks": [
    {
      "type": "line",
      "properties": {
        "update": {
          "stroke": {
            "value": "black"
          },
          "strokeWidth": {
            "value": 2
          },
          "x": {
            "scale": "x",
            "field": "data.pred_"
          },
          "y": {
            "scale": "y",
            "field": "data.resp_"
          },
          "fill": {
            "value": "transparent"
          }
        },
        "ggvis": {
          "data": {
            "value": ".0/model_prediction1"
          }
        }
      },
      "from": {
        "data": ".0/model_prediction1"
      }
    },
    {
      "type": "symbol",
      "properties": {
        "update": {
          "fill": {
            "value": "purple"
          },
          "stroke": {
            "value": "black"
          },
          "x": {
            "scale": "x",
            "field": "data.wt"
          },
          "y": {
            "scale": "y",
            "field": "data.mpg"
          },
          "size": {
            "field": "data.reactive_137215067"
          }
        },
        "ggvis": {
          "data": {
            "value": ".0"
          }
        }
      },
      "from": {
        "data": ".0"
      }
    }
  ],
  "legends": [],
  "axes": [
    {
      "type": "x",
      "scale": "x",
      "orient": "bottom",
      "layer": "back",
      "grid": true,
      "title": "wt"
    },
    {
      "type": "y",
      "scale": "y",
      "orient": "left",
      "layer": "back",
      "grid": true,
      "title": "mpg"
    }
  ],
  "padding": null,
  "ggvis_opts": {
    "keep_aspect": false,
    "resizable": true,
    "padding": {},
    "duration": 250,
    "renderer": "svg",
    "hover_duration": 0,
    "width": "50%",
    "height": 480
  },
  "handlers": null
};
ggvis.getPlot("plot_id812560195").parseSpec(plot_id812560195_spec);
</script>
<p>This particular plot has two sliders which you can play with to:</p>
<ul>
<li>adjust the size of the data points;</li>
<li>adjust the smoothness of the line.</li>
</ul>
<p>If you decrease the smoothness, then the line will start to become more wobbly and intersect more points, whereas if you increase the smoothness, the line will instead capture the general shape of the data, rather than specific points.</p>
<p>Note the message in the RStudio Console “Showing dynamic visualisation. Press Escape/Ctrl + C to stop”. You must press either of these key combinations, or the Stop icon in the RStudio Viewer, to continue submitting R commands in your R session.</p>
<p>When modelling a dataset we often make assumptions about how the data is generated. For example, do the residuals follow an underlying Normal distribution, and if so, can we estimate it’s parameters. Alternatively, the data may be distributed as a Poisson, Gamma, or Chi-squared distribution. It’s not always appropriate to assume that the data fits some pre-specified distributional family, especially if we don’t have a lot of data. Instead, we may want to model the data without making such distributional assumptions. In statistics this is known as nonparametrics, and the most common type of nonparametric density estimation is <em>kernel density estimation</em>. Further details can be found here <a href="https://en.wikipedia.org/wiki/Kernel_density_estimation" class="uri">https://en.wikipedia.org/wiki/Kernel_density_estimation</a>.</p>
<p>Essentially kernel density estimation replaces each data point with a kernel function (e.g. Gaussian, Epanechnikov), and aims to approximate the underlying population density by smoothing your data (which is assumed to be a sample from the population).</p>
<p>Run the code below and see what happens when you change the kernel function and smoothing parameter (more commonly known as the bandwidth).</p>
<div class="sourceCode" id="cb584"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb584-1"><a href="web-app.html#cb584-1" tabindex="-1"></a><span class="co"># In this plot we have an input slider to select the bandwidth of smoother</span></span>
<span id="cb584-2"><a href="web-app.html#cb584-2" tabindex="-1"></a>mtcars <span class="sc">%&gt;%</span> </span>
<span id="cb584-3"><a href="web-app.html#cb584-3" tabindex="-1"></a>    <span class="fu">ggvis</span>(<span class="sc">~</span>wt) <span class="sc">%&gt;%</span></span>
<span id="cb584-4"><a href="web-app.html#cb584-4" tabindex="-1"></a>    <span class="fu">layer_densities</span>(</span>
<span id="cb584-5"><a href="web-app.html#cb584-5" tabindex="-1"></a>        <span class="at">adjust =</span> <span class="fu">input_slider</span>(</span>
<span id="cb584-6"><a href="web-app.html#cb584-6" tabindex="-1"></a>            .<span class="dv">1</span>, <span class="dv">2</span>, <span class="at">value =</span> <span class="dv">1</span>, <span class="at">step =</span> .<span class="dv">1</span>, </span>
<span id="cb584-7"><a href="web-app.html#cb584-7" tabindex="-1"></a>            <span class="at">label =</span> <span class="st">&quot;Bandwidth adjustment&quot;</span></span>
<span id="cb584-8"><a href="web-app.html#cb584-8" tabindex="-1"></a>        ), </span>
<span id="cb584-9"><a href="web-app.html#cb584-9" tabindex="-1"></a>        <span class="at">kernel =</span> <span class="fu">input_select</span>(</span>
<span id="cb584-10"><a href="web-app.html#cb584-10" tabindex="-1"></a>            <span class="fu">c</span>(<span class="st">&quot;Gaussian&quot;</span> <span class="ot">=</span> <span class="st">&quot;gaussian&quot;</span>,</span>
<span id="cb584-11"><a href="web-app.html#cb584-11" tabindex="-1"></a>              <span class="st">&quot;Epanechnikov&quot;</span> <span class="ot">=</span> <span class="st">&quot;epanechnikov&quot;</span>,</span>
<span id="cb584-12"><a href="web-app.html#cb584-12" tabindex="-1"></a>              <span class="st">&quot;Rectangular&quot;</span> <span class="ot">=</span> <span class="st">&quot;rectangular&quot;</span>,</span>
<span id="cb584-13"><a href="web-app.html#cb584-13" tabindex="-1"></a>              <span class="st">&quot;Triangular&quot;</span> <span class="ot">=</span> <span class="st">&quot;triangular&quot;</span>,</span>
<span id="cb584-14"><a href="web-app.html#cb584-14" tabindex="-1"></a>              <span class="st">&quot;Biweight&quot;</span> <span class="ot">=</span> <span class="st">&quot;biweight&quot;</span>,</span>
<span id="cb584-15"><a href="web-app.html#cb584-15" tabindex="-1"></a>              <span class="st">&quot;Cosine&quot;</span> <span class="ot">=</span> <span class="st">&quot;cosine&quot;</span>,</span>
<span id="cb584-16"><a href="web-app.html#cb584-16" tabindex="-1"></a>              <span class="st">&quot;Optcosine&quot;</span> <span class="ot">=</span> <span class="st">&quot;optcosine&quot;</span>),</span>
<span id="cb584-17"><a href="web-app.html#cb584-17" tabindex="-1"></a>            <span class="at">label =</span> <span class="st">&quot;Kernel&quot;</span></span>
<span id="cb584-18"><a href="web-app.html#cb584-18" tabindex="-1"></a>        )</span>
<span id="cb584-19"><a href="web-app.html#cb584-19" tabindex="-1"></a>    )</span></code></pre></div>
<pre><code>## Warning: Can&#39;t output dynamic/interactive ggvis plots in a knitr document.
## Generating a static (non-dynamic, non-interactive) version of the plot.</code></pre>
<div id="plot_id680721530-container" class="ggvis-output-container">
<div id="plot_id680721530" class="ggvis-output"></div>
<div class="plot-gear-icon">
<nav class="ggvis-control">
<a class="ggvis-dropdown-toggle" title="Controls" onclick="return false;"></a>
<ul class="ggvis-dropdown">
<li>
Renderer: 
<a id="plot_id680721530_renderer_svg" class="ggvis-renderer-button" onclick="return false;" data-plot-id="plot_id680721530" data-renderer="svg">SVG</a>
 | 
<a id="plot_id680721530_renderer_canvas" class="ggvis-renderer-button" onclick="return false;" data-plot-id="plot_id680721530" data-renderer="canvas">Canvas</a>
</li>
<li>
<a id="plot_id680721530_download" class="ggvis-download" data-plot-id="plot_id680721530">Download</a>
</li>
</ul>
</nav>
</div>
</div>
<script type="text/javascript">
var plot_id680721530_spec = {
  "data": [
    {
      "name": ".0/density1",
      "format": {
        "type": "csv",
        "parse": {
          "pred_": "number",
          "resp_": "number"
        }
      },
      "values": "\"pred_\",\"resp_\"\n0.47657276119403,0.000582725156452163\n0.500038857184665,0.00071767680963822\n0.5235049531753,0.000882417712840549\n0.546971049165935,0.00107730900396994\n0.57043714515657,0.00131143374199467\n0.593903241147205,0.00159000835112015\n0.61736933713784,0.00191516520503772\n0.640835433128475,0.00230371954420307\n0.66430152911911,0.00275521469239293\n0.687767625109745,0.00327796091829257\n0.71123372110038,0.00389218122316375\n0.734699817091015,0.00459354285655425\n0.75816591308165,0.00540125248687114\n0.781632009072285,0.00632808260421522\n0.80509810506292,0.00737236983899025\n0.828564201053556,0.00856630663438078\n0.852030297044191,0.00990674103470914\n0.875496393034826,0.0113997638421663\n0.898962489025461,0.0130858641111554\n0.922428585016096,0.0149441010997594\n0.945894681006731,0.0169985912761815\n0.969360776997366,0.0192691864507706\n0.992826872988001,0.0217388156799297\n1.01629296897864,0.0244443826107599\n1.03975906496927,0.0273760370223619\n1.06322516095991,0.030523345628305\n1.08669125695054,0.0339344335179344\n1.11015735294118,0.0375647565886191\n1.13362344893181,0.041425368927415\n1.15708954492245,0.0455315816659798\n1.18055564091308,0.0498452675936595\n1.20402173690372,0.0543835777175255\n1.22748783289435,0.0591277146236436\n1.25095392888499,0.0640495863933788\n1.27442002487562,0.06916580765795\n1.29788612086626,0.0744324058983953\n1.32135221685689,0.0798351046672024\n1.34481831284753,0.0853684911926308\n1.36828440883816,0.0909934846149436\n1.3917505048288,0.0966977502384678\n1.41521660081943,0.102457991788576\n1.43868269681007,0.108248317779379\n1.4621487928007,0.11404906863764\n1.48561488879134,0.119837459239821\n1.50908098478197,0.125594718006477\n1.53254708077261,0.131292982740594\n1.55601317676324,0.136923793650901\n1.57947927275388,0.142464610750204\n1.60294536874451,0.147895814650928\n1.62641146473515,0.153216949407692\n1.64987756072578,0.158398546624634\n1.67334365671642,0.16344148694186\n1.69680975270705,0.16834607682548\n1.72027584869769,0.17307636986152\n1.74374194468832,0.177658011073586\n1.76720804067896,0.182078038298989\n1.79067413666959,0.186322930159357\n1.81414023266023,0.190414526322915\n1.83760632865086,0.194333446672905\n1.8610724246415,0.198089446887992\n1.88453852063213,0.201697117274925\n1.90800461662277,0.205131350868437\n1.9314707126134,0.208422443958554\n1.95493680860404,0.211570324517894\n1.97840290459467,0.214565061491999\n2.00186900058531,0.217433828100919\n2.02533509657594,0.220168886469178\n2.04880119256658,0.222778865533785\n2.07226728855721,0.225281765963378\n2.09573338454785,0.227667405678761\n2.11919948053848,0.229958217011926\n2.14266557652912,0.232162964084006\n2.16613167251975,0.234279580533967\n2.18959776851039,0.236331556142363\n2.21306386450102,0.238323668364685\n2.23652996049166,0.240266790222826\n2.25999605648229,0.242177494541761\n2.28346215247293,0.244064957129233\n2.30692824846356,0.245945052584516\n2.3303943444542,0.247831009459008\n2.35386044044483,0.249741600523526\n2.37732653643547,0.251687978972875\n2.4007926324261,0.253688585835457\n2.42425872841674,0.255765112062246\n2.44772482440737,0.25792481395396\n2.47119092039801,0.260198646731506\n2.49465701638864,0.262599221119561\n2.51812311237928,0.265134890200947\n2.54158920836992,0.267855957328145\n2.56505530436055,0.270752060467896\n2.58852140035119,0.273849818611084\n2.61198749634182,0.277191184584018\n2.63545359233246,0.280761865641523\n2.65891968832309,0.284609553261573\n2.68238578431373,0.288747572072958\n2.70585188030436,0.293167533297596\n2.729317976295,0.297940335848035\n2.75278407228563,0.303034716751968\n2.77625016827627,0.308464496585081\n2.7997162642669,0.314287054462057\n2.82318236025754,0.320449835550487\n2.84664845624817,0.326989779899034\n2.87011455223881,0.333909903844988\n2.89358064822944,0.341166041388881\n2.91704674422008,0.348800388521983\n2.94051284021071,0.356757634492079\n2.96397893620135,0.365006399985949\n2.98744503219198,0.373563206624873\n3.01091112818262,0.382341447242507\n3.03437722417325,0.391315950276781\n3.05784332016389,0.400441433339057\n3.08130941615452,0.409646855580623\n3.10477551214516,0.418875121431129\n3.12824160813579,0.42805436118754\n3.15170770412643,0.437121829600756\n3.17517380011706,0.44596166838127\n3.1986398961077,0.4545330057285\n3.22210599209833,0.462741392435135\n3.24557208808897,0.47046296850915\n3.2690381840796,0.477681946382372\n3.29250428007024,0.484248280467516\n3.31597037606087,0.490101648823941\n3.33943647205151,0.495230142542292\n3.36290256804214,0.499414324239238\n3.38636866403278,0.502723460752877\n3.40983476002341,0.50508803556573\n3.43330085601405,0.506336272777962\n3.45676695200468,0.506592964117382\n3.48023304799532,0.505722374835992\n3.50369914398595,0.503703618035211\n3.52716523997659,0.50063813241482\n3.55063133596722,0.496348336485927\n3.57409743195786,0.490980525217578\n3.59756352794849,0.484574291253099\n3.62102962393913,0.476995383213723\n3.64449571992976,0.468470339712835\n3.6679618159204,0.458965255518182\n3.69142791191103,0.448505918965787\n3.71489400790167,0.437257972969431\n3.7383601038923,0.425177720992265\n3.76182619988294,0.412405762310802\n3.78529229587357,0.399049651025859\n3.80875839186421,0.385085010470726\n3.83222448785484,0.3706983835789\n3.85569058384548,0.355941081578664\n3.87915667983611,0.340877894787958\n3.90262277582675,0.325626006335169\n3.92608887181738,0.310246651303369\n3.94955496780802,0.294826903721194\n3.97302106379865,0.279438344321508\n3.99648715978929,0.264171143516192\n4.01995325577992,0.249074345751988\n4.04341935177056,0.234212922626186\n4.06688544776119,0.219678835679824\n4.09035154375183,0.205477528778619\n4.11381763974246,0.191696651760425\n4.1372837357331,0.178376970278526\n4.16074983172373,0.165511878423602\n4.18421592771437,0.153219571943271\n4.207682023705,0.14145915251711\n4.23114811969564,0.130248754652909\n4.25461421568627,0.119692496060276\n4.27808031167691,0.109702675273433\n4.30154640766754,0.100342356564841\n4.32501250365818,0.0916333146152962\n4.34847859964882,0.0835090660196579\n4.37194469563945,0.0760620074047877\n4.39541079163009,0.069229091910607\n4.41887688762072,0.062979555131221\n4.44234298361136,0.0574169694073286\n4.46580907960199,0.0524168078139785\n4.48927517559263,0.0480109634495236\n4.51274127158326,0.0442228237402234\n4.5362073675739,0.0409655928310299\n4.55967346356453,0.038298836711546\n4.58313955955517,0.0361749357882657\n4.6066056555458,0.0345434213572929\n4.63007175153644,0.0334865913917498\n4.65353784752707,0.0328964171859535\n4.67700394351771,0.0327780953914883\n4.70047003950834,0.0331582740240336\n4.72393613549898,0.0339511130678429\n4.74740223148961,0.0351849675567697\n4.77086832748025,0.0368271849500335\n4.79433442347088,0.0388215843685152\n4.81780051946152,0.0412038835820174\n4.84126661545215,0.0438959725590719\n4.86473271144279,0.0468721525721499\n4.88819880743342,0.0501346610121506\n4.91166490342406,0.0536068703425014\n4.93513099941469,0.0572720672734569\n4.95859709540533,0.0610904816879012\n4.98206319139596,0.0650078866361907\n5.0055292873866,0.068991751689252\n5.02899538337723,0.0729897814927435\n5.05246147936787,0.0769593654619368\n5.0759275753585,0.0808406450377532\n5.09939367134914,0.0846023046761732\n5.12285976733977,0.0881893676689716\n5.14632586333041,0.0915447222209982\n5.16979195932104,0.09465489872772\n5.19325805531168,0.0974406249952673\n5.21672415130231,0.0998860704569711\n5.24019024729295,0.101983273402178\n5.26365634328358,0.103625810206064\n5.28712243927422,0.104868602319546\n5.31058853526485,0.105672181943653\n5.33405463125549,0.105986505117807\n5.35752072724612,0.105870741267348\n5.38098682323676,0.105271868801769\n5.40445291922739,0.104213744636893\n5.42791901521803,0.102744755827444\n5.45138511120866,0.100808303960984\n5.4748512071993,0.0984939028681114\n5.49831730318993,0.0958210516768162\n5.52178339918057,0.0927821862454773\n5.5452494951712,0.0894653120455096\n5.56871559116184,0.0858803981601834\n5.59218168715247,0.082070241479592\n5.61564778314311,0.0780949474741861\n5.63911387913374,0.0739735840558051\n5.66257997512438,0.0697640439943275\n5.68604607111501,0.0655050674919462\n5.70951216710565,0.0612333723144883\n5.73297826309628,0.0569864845238171\n5.75644435908692,0.052799815113035\n5.77991045507755,0.0487083844482486\n5.80337655106819,0.0447270543403124\n5.82684264705882,0.0408981780274895\n5.85030874304946,0.0372299460015761\n5.87377483904009,0.0337280397219396\n5.89724093503073,0.0304413095190627\n5.92070703102136,0.0273411207710342\n5.944173127012,0.0244452093859307\n5.96763922300263,0.0217709580721256\n5.99110531899327,0.0192898916829638\n6.0145714149839,0.017024325964557\n6.03803751097454,0.0149591336361713\n6.06150360696517,0.0130731035415413\n6.08496970295581,0.0113915951554944\n6.10843579894645,0.00987420646958876\n6.13190189493708,0.00851629034826122\n6.15536799092772,0.00732311092497793\n6.17883408691835,0.00626049533970772\n6.20230018290898,0.0053313563908888\n6.22576627889962,0.00452224156481578\n6.24923237489025,0.00381206824341588\n6.27269847088089,0.00320631135039812\n6.29616456687152,0.00268226456540116\n6.31963066286216,0.00223066128278318\n6.3430967588528,0.00185226944649606\n6.36656285484343,0.00152782290323543\n6.39002895083407,0.00125496320941866\n6.4134950468247,0.00102772118947489\n6.43696114281534,0.00083558749992845\n6.46042723880597,0.000678181068599915"
    },
    {
      "name": "scale/x",
      "format": {
        "type": "csv",
        "parse": {
          "domain": "number"
        }
      },
      "values": "\"domain\"\n0.177380037313432\n6.75961996268657"
    },
    {
      "name": "scale/y",
      "format": {
        "type": "csv",
        "parse": {
          "domain": "number"
        }
      },
      "values": "\"domain\"\n-0.0253296482058691\n0.531922612323251"
    }
  ],
  "scales": [
    {
      "name": "x",
      "domain": {
        "data": "scale/x",
        "field": "data.domain"
      },
      "zero": false,
      "nice": false,
      "clamp": false,
      "range": "width"
    },
    {
      "name": "y",
      "domain": {
        "data": "scale/y",
        "field": "data.domain"
      },
      "zero": false,
      "nice": false,
      "clamp": false,
      "range": "height"
    }
  ],
  "marks": [
    {
      "type": "area",
      "properties": {
        "update": {
          "fill": {
            "value": "#333333"
          },
          "y2": {
            "scale": "y",
            "value": 0
          },
          "fillOpacity": {
            "value": 0.2
          },
          "x": {
            "scale": "x",
            "field": "data.pred_"
          },
          "y": {
            "scale": "y",
            "field": "data.resp_"
          },
          "stroke": {
            "value": "transparent"
          }
        },
        "ggvis": {
          "data": {
            "value": ".0/density1"
          }
        }
      },
      "from": {
        "data": ".0/density1"
      }
    },
    {
      "type": "line",
      "properties": {
        "update": {
          "stroke": {
            "value": "#000000"
          },
          "x": {
            "scale": "x",
            "field": "data.pred_"
          },
          "y": {
            "scale": "y",
            "field": "data.resp_"
          },
          "fill": {
            "value": "transparent"
          }
        },
        "ggvis": {
          "data": {
            "value": ".0/density1"
          }
        }
      },
      "from": {
        "data": ".0/density1"
      }
    }
  ],
  "legends": [],
  "axes": [
    {
      "type": "x",
      "scale": "x",
      "orient": "bottom",
      "layer": "back",
      "grid": true,
      "title": "wt"
    },
    {
      "type": "y",
      "scale": "y",
      "orient": "left",
      "layer": "back",
      "grid": true,
      "title": "density"
    }
  ],
  "padding": null,
  "ggvis_opts": {
    "keep_aspect": false,
    "resizable": true,
    "padding": {},
    "duration": 250,
    "renderer": "svg",
    "hover_duration": 0,
    "width": "50%",
    "height": 480
  },
  "handlers": null
};
ggvis.getPlot("plot_id680721530").parseSpec(plot_id680721530_spec);
</script>
<p>The plot allows you to choose which kernel you are using and also to adjust the bandwidth. This is much more convenient than plotting many different plots.</p>
</div>
</div>
<div id="shiny-web-applications" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Shiny Web Applications<a href="web-app.html#shiny-web-applications" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The team behind RStudio have created an application framework which allows the user to create web pages which R code. One example, of this is we can create interactive plots like those generated by <code>ggvis</code>, however using whichever plotting environment we prefer. But these apps can achieve much more, being even capable of creating a front-end to your whole statistical analysis. Within an app, you can import, analyse and plot your data completely, so when combined with <code>tidyverse</code>, <code>ggplot</code> and <code>plotly</code>, you can build from scratch powerful Statistical and ML tools in matters of hours.</p>
<p>To create a new app in RStudio follow this procedure:</p>
<ul>
<li>click the New icon | Shiny Web App…</li>
<li>Give yours a name with no spaces such as ``example-shiny-app’’.</li>
<li>Choose the single of multiple file approach to coding the app (it doesn’t really matter which you choose)</li>
<li>and choose which directory (folder) that you want to make it in.</li>
</ul>
<p>If you chose the single file approach you now get a single file called <code>app.R</code> to edit. However the placeholder code provided by RStudio will actually run. Click the “Run App” button in the top right corner of the Source pane. RStudio will open a new Viewer window running the app.</p>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-250"></span>
<img src="week5/example-shiny-app.png" alt="Example Shiny App by RStudio." width="\linewidth" />
<p class="caption">
Figure 5.1: Example Shiny App by RStudio.
</p>
</div>
<p>As with the <code>ggvis</code> interactive plots you see that you can move the slider with your mouse and R recalculates and redraws the plot. Experiment with moving the slider.</p>
<p>Shiny Apps are very flexible because they need not just produce plots but they provide Web frontends to any type of R code. So you could be providing access to web scraping code or access to a database.</p>
<p>Inspect the structure of the code. It is very simple. There are two main functions <code>ui()</code> (which stands for user-interface) and <code>server()</code> which is the part of the code doing the computation/plots. You would edit these functions to perform the task you needed to achieve.</p>
<p>Whilst your app is running you will notice that the RStudio console reports “Listening on <a href="http://127.0.0.1:4122" class="uri">http://127.0.0.1:4122</a>”. In order to be able to resume your R session you must close the window your app is running in.</p>
<div id="other-rstudio-features-we-havent-covered" class="section level3 hasAnchor" number="5.4.1">
<h3><span class="header-section-number">5.4.1</span> Other RStudio features we haven’t covered<a href="web-app.html#other-rstudio-features-we-havent-covered" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>RStudio has many features we haven’t covered. It has brilliant features when you are building your own package. A previous lecturer of this module said personally they would never build a package outside of RStudio anymore. (Personally, I only do it when testing packages with self-build R versions) When building a package and some other tasks you need the RStudio “Build” pane. To see this I think you must define the top level directory for your package (or bookdown book etc.) as an RStudio project. This creates an <code>.Rproj</code> file in the directory which RStudio detects and then shows the Build pane.</p>
<p>RStudio can also run Sweave documents (which contain both LaTeX and R code) and also many types of presentation including LaTeX beamer and RStudio’s <code>.Rpres</code> format.</p>
</div>
</div>
<div id="rmarkdown-html-notebooks-and-ipythonjupyter-notebooks" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> Rmarkdown HTML notebooks and Ipython/Jupyter notebooks<a href="web-app.html#rmarkdown-html-notebooks-and-ipythonjupyter-notebooks" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You may have already written Rmarkdown files to generate documents by now. An advanced type of Rmarkdown document is an “R Notebook”. These are R markdown files with the <code>output</code> in the YAML header defined as</p>
<pre><code>output:
  html_notebook: default</code></pre>
<p>When you first save an Rmarkdown file with this output definition its output file with extension <code>.nb.html</code> is created immediately (even if you have not evaluated any of your code blocks).</p>
<p>The <code>.nb.html</code> file format is very clever because it actually contains the Rmarkdown code as well as the html output. Therefore, if you open an <code>.nb.html</code> file in RStudio it will show the associated <code>.Rmd</code> code even if you don’t have that separate file.</p>
<p>The R output shown in the <code>.nb.html</code> file is the output from the code blocks which have been run, i.e. if you have not evaluated all of the R code blocks in your Rmd file then not all of the output will be present in the <code>.nb.html</code> file.</p>
<p>The other main notebook format used in Data Science are Ipython/Jupyter notebooks <a href="https://jupyter.org/" class="uri">https://jupyter.org/</a>. These keep the R read-evaluation-print-loop running in the background so you can evaluate one cell of code at a time live in your browser. A screen shot of an example notebook is shown at side of the page.</p>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-251"></span>
<img src="week5/jupyter-notebook-example.png" alt="Example Jupyter notebook." width="\linewidth" />
<p class="caption">
Figure 5.2: Example Jupyter notebook.
</p>
</div>
<p>To try a Jupyter notebook without having to install it on your local machine, you can try it in a browser at <a href="https://jupyter.org/try" class="uri">https://jupyter.org/try</a>. However, some didn’t have good experience with this website. Either the R kernel dies or you cannot get a space to launch a notebook. Running Jupyter notebooks on my own machine has been reliable.</p>
<p>If you want to try such notebooks installation instructions are here: <a href="https://jupyter.org/install.html" class="uri">https://jupyter.org/install.html</a>. This is easiest to do on your own computer. If you are on a University Windows network computer these will probably fail. One element of getting Jupyter notebooks running is installing the IPython/Jupyter R kernel (the notebooks can use kernels for other languages such as Python, Julia, and many other languages). Instructions can be found here <a href="https://irkernel.github.io/installation/" class="uri">https://irkernel.github.io/installation/</a>.</p>
</div>
<div id="exercise-housing-in-nairobi" class="section level2 hasAnchor" number="5.6">
<h2><span class="header-section-number">5.6</span> Exercise: Housing in Nairobi<a href="web-app.html#exercise-housing-in-nairobi" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong><em>Caution: The code in this section may not work if the website changes its structure and layout.</em></strong></p>
<p>We’ve now covered the basics of the <code>rvest</code> and <code>ggvis</code> packages. We’re now going look at combining these packages, along with other <code>tidyverse</code> packages to perform statistical analysis on dataset we have scraped from the web.</p>
<p>The property market is a rich source of data which contains many interesting nuances. For example, just because a property is big, doesn’t mean it’s expensive.</p>
<p>Have a look at <a href="https://kenyapropertycentre.com" class="uri">https://kenyapropertycentre.com</a> to get an idea of its layout. Try searching for some properties. The code below will extract the address, price, the number of bedrooms and bathrooms, and when the advert was added of each property in the search results:</p>
<div class="sourceCode" id="cb587"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb587-1"><a href="web-app.html#cb587-1" tabindex="-1"></a>listings <span class="ot">&lt;-</span> <span class="fu">read_html</span>(<span class="st">&quot;https://kenyapropertycentre.com/for-sale/houses/nairobi/showtype?page=1&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb587-2"><a href="web-app.html#cb587-2" tabindex="-1"></a>  <span class="fu">html_elements</span>(<span class="st">&quot;.property-list&quot;</span>)</span>
<span id="cb587-3"><a href="web-app.html#cb587-3" tabindex="-1"></a>  </span>
<span id="cb587-4"><a href="web-app.html#cb587-4" tabindex="-1"></a><span class="co"># extract html details</span></span>
<span id="cb587-5"><a href="web-app.html#cb587-5" tabindex="-1"></a>address <span class="ot">&lt;-</span> listings <span class="sc">%&gt;%</span></span>
<span id="cb587-6"><a href="web-app.html#cb587-6" tabindex="-1"></a>    <span class="fu">html_element</span>(<span class="st">&quot;.voffset-bottom-10 strong&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb587-7"><a href="web-app.html#cb587-7" tabindex="-1"></a>    <span class="fu">html_text</span>()</span>
<span id="cb587-8"><a href="web-app.html#cb587-8" tabindex="-1"></a></span>
<span id="cb587-9"><a href="web-app.html#cb587-9" tabindex="-1"></a>price <span class="ot">&lt;-</span> listings <span class="sc">%&gt;%</span> </span>
<span id="cb587-10"><a href="web-app.html#cb587-10" tabindex="-1"></a>    <span class="fu">html_element</span>(<span class="st">&quot;.price+.price&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb587-11"><a href="web-app.html#cb587-11" tabindex="-1"></a>    <span class="fu">html_text</span>() <span class="sc">%&gt;%</span></span>
<span id="cb587-12"><a href="web-app.html#cb587-12" tabindex="-1"></a>    readr<span class="sc">::</span><span class="fu">parse_number</span>()</span>
<span id="cb587-13"><a href="web-app.html#cb587-13" tabindex="-1"></a></span>
<span id="cb587-14"><a href="web-app.html#cb587-14" tabindex="-1"></a>beds <span class="ot">&lt;-</span> listings <span class="sc">%&gt;%</span></span>
<span id="cb587-15"><a href="web-app.html#cb587-15" tabindex="-1"></a>    <span class="fu">html_element</span>(<span class="st">&quot;.fa-bed+ span&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb587-16"><a href="web-app.html#cb587-16" tabindex="-1"></a>    <span class="fu">html_text</span>() <span class="sc">%&gt;%</span></span>
<span id="cb587-17"><a href="web-app.html#cb587-17" tabindex="-1"></a>    readr<span class="sc">::</span><span class="fu">parse_number</span>()</span>
<span id="cb587-18"><a href="web-app.html#cb587-18" tabindex="-1"></a></span>
<span id="cb587-19"><a href="web-app.html#cb587-19" tabindex="-1"></a>baths <span class="ot">&lt;-</span> listings <span class="sc">%&gt;%</span></span>
<span id="cb587-20"><a href="web-app.html#cb587-20" tabindex="-1"></a>    <span class="fu">html_element</span>(<span class="st">&quot;.fa-bath+ span&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb587-21"><a href="web-app.html#cb587-21" tabindex="-1"></a>    <span class="fu">html_text</span>() <span class="sc">%&gt;%</span></span>
<span id="cb587-22"><a href="web-app.html#cb587-22" tabindex="-1"></a>    readr<span class="sc">::</span><span class="fu">parse_number</span>()</span>
<span id="cb587-23"><a href="web-app.html#cb587-23" tabindex="-1"></a></span>
<span id="cb587-24"><a href="web-app.html#cb587-24" tabindex="-1"></a>date_added <span class="ot">&lt;-</span> listings <span class="sc">%&gt;%</span></span>
<span id="cb587-25"><a href="web-app.html#cb587-25" tabindex="-1"></a>    <span class="fu">html_element</span>(<span class="st">&quot;.added-on+.added-on&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb587-26"><a href="web-app.html#cb587-26" tabindex="-1"></a>    <span class="fu">html_text</span>()</span>
<span id="cb587-27"><a href="web-app.html#cb587-27" tabindex="-1"></a></span>
<span id="cb587-28"><a href="web-app.html#cb587-28" tabindex="-1"></a>housing <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(address, price, beds, baths, date_added)</span></code></pre></div>
<p>You may get some warnings/errors when you run this code. Let’s ignore those for the moment. You’ll find scraping data from website is never trivial. Web developers design their sites to be pretty and not scraper friendly. Companies that specialise in web scraping spend a significant portion of their time updating scrapers when websites are updated.</p>
<p>Your task is to utilise what you’ve learnt over the past few weeks to perform some statistical analyses on these data. Here are some suggestions for things to explore.</p>
<ul>
<li>Some values may be missing. Find a way to impute the missing values for some properties. You will need the functions with the prefix <code>map</code> from the <code>purrr</code> package, which we didn’t have time to cover.</li>
<li>Can we write a function to trim the code above, as almost all vectors are created by the use of <code>html_nodes()</code>, <code>html_text()</code>, and <code>readr::parse_number()</code>?</li>
<li>As we saw with the Google Scholar data, when we scrape data from a website we’re only scraping what is on that particular page. This is fine, but if the data we want is over multiple pages then we need to be clever. Try to use a <code>for</code> loop to loop over each webpage and scrape the data you want. <em>Hint: Most websites follow a logical naming and numbering structure.</em></li>
<li>Do the same thing for London, UK (or any other city of your choice). A possible website to look at is <a href="https://www.zoopla.co.uk/" class="uri">https://www.zoopla.co.uk/</a>.</li>
<li>It’s always a good idea to take a look at the data. The two most obvious functions to use here would be <code>View()</code> and <code>head()</code>.</li>
<li>It’s also a good idea to look at some simple summary statistics, such as mean, median, max, etc. Another useful function for summarising your data is <code>summary()</code>. Note that this function will only work on numeric class data. If there are any non-numeric values in your data fix your data frame so that the appropriate columns are of class numeric.</li>
<li>You may want to look at the price as a function of the date.</li>
<li>Create an interactive <code>ggvis</code> plot to explore one or more variables.</li>
</ul>
<p>Explore the data set. Be creative!</p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="14">
<li id="fn14"><p>R was not really designed for this sort of task. Other programming languages, such as Python, are generally better for web scraping.<a href="web-app.html#fnref14" class="footnote-back">↩︎</a></p></li>
<li id="fn15"><p>Search for this in the Chrome Web Store <a href="https://chrome.google.com/webstore/category/extensions" class="uri">https://chrome.google.com/webstore/category/extensions</a><a href="web-app.html#fnref15" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="string.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="further-reading.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
